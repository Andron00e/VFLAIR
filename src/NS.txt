================= iter seed  97  =================
===== No Defense ======
running on cuda0
============ apply_trainable_layer= 0 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/0/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.01 train_acc:1.00 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.01 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.01 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|0|3|No_Attack|None|0.9990543735224586|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
init pos_idx: 510 tensor(0, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 511
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[ 0.00051403 -0.00051403]
 [ 0.00056386 -0.00056386]
 [ 0.00054398 -0.00054398]
 ...
 [ 0.00054799 -0.00054799]
 [ 0.00046181 -0.00046181]
 [ 0.00056359 -0.00056359]]
negative gradients:[[-0.00043667  0.00043667]
 [-0.0004405   0.0004405 ]
 [-0.00045838  0.00045838]
 [-0.00042031  0.00042031]
 [-0.00039649  0.00039649]
 [-0.00047386  0.00047386]
 [-0.00043103  0.00043103]
 [-0.00040265  0.00040265]
 [-0.00042277  0.00042277]
 [-0.00049357  0.00049357]
 [-0.00043841  0.00043841]
 [-0.00037714  0.00037714]
 [-0.00040619  0.00040619]
 [-0.00039342  0.00039342]
 [-0.00046646  0.00046646]
 [-0.00035359  0.00035359]
 [-0.00041028  0.00041028]
 [-0.0004727   0.0004727 ]
 [-0.00053631  0.00053631]
 [-0.00042165  0.00042165]
 [-0.00056571  0.00056571]
 [-0.00041428  0.00041428]
 [-0.00047712  0.00047712]
 [-0.00042426  0.00042426]
 [-0.00053815  0.00053815]
 [-0.00042151  0.00042151]
 [-0.00043613  0.00043613]
 [-0.00037266  0.00037266]
 [-0.00048006  0.00048006]
 [-0.00042441  0.00042441]
 [-0.00045515  0.00045515]
 [-0.00046658  0.00046658]
 [-0.00041936  0.00041935]
 [-0.00045625  0.00045625]
 [-0.00041518  0.00041518]
 [-0.00054037  0.00054037]
 [-0.00039558  0.00039558]
 [-0.00049855  0.00049855]
 [-0.00043476  0.00043476]
 [-0.00051012  0.00051012]
 [-0.0003911   0.00039109]
 [-0.00044473  0.00044473]
 [-0.00033899  0.00033899]
 [-0.00046017  0.00046017]
 [-0.00050302  0.00050302]
 [-0.00043089  0.00043089]
 [-0.00038074  0.00038074]
 [-0.00039873  0.00039873]
 [-0.00039654  0.00039654]
 [-0.00041614  0.00041614]
 [-0.00044069  0.00044069]
 [-0.00040082  0.00040082]
 [-0.00045846  0.00045846]
 [-0.0004572   0.0004572 ]
 [-0.0004049   0.0004049 ]
 [-0.00044485  0.00044485]
 [-0.00038101  0.00038101]
 [-0.00044432  0.00044432]
 [-0.00051016  0.00051016]
 [-0.00047183  0.00047183]
 [-0.00042399  0.00042399]
 [-0.00043011  0.00043011]
 [-0.00044885  0.00044885]
 [-0.00044596  0.00044596]
 [-0.00044208  0.00044208]
 [-0.00041144  0.00041144]
 [-0.00037201  0.00037201]
 [-0.00044731  0.00044731]
 [-0.00045936  0.00045936]
 [-0.00045102  0.00045102]
 [-0.00039313  0.00039313]
 [-0.00042587  0.00042587]
 [-0.00041291  0.00041291]
 [-0.00041779  0.00041779]
 [-0.0004754   0.0004754 ]
 [-0.00045543  0.00045543]
 [-0.00042707  0.00042707]
 [-0.00043634  0.00043634]
 [-0.00043066  0.00043066]
 [-0.00044783  0.00044783]
 [-0.00041894  0.00041894]
 [-0.00042427  0.00042427]
 [-0.00051038  0.00051038]
 [-0.00058118  0.00058118]
 [-0.00045523  0.00045523]
 [-0.00038836  0.00038836]
 [-0.00045298  0.00045298]
 [-0.00041054  0.00041054]
 [-0.00047525  0.00047525]
 [-0.00045292  0.00045292]
 [-0.00038424  0.00038424]
 [-0.00049636  0.00049636]
 [-0.00039415  0.00039415]
 [-0.00044754  0.00044754]
 [-0.00045707  0.00045707]
 [-0.00039423  0.00039423]
 [-0.00042383  0.00042383]
 [-0.00032023  0.00032023]
 [-0.00039029  0.00039029]
 [-0.00045272  0.00045272]
 [-0.00044002  0.00044002]
 [-0.00049172  0.00049172]
 [-0.00048599  0.00048599]
 [-0.00045153  0.00045153]
 [-0.00036511  0.00036511]
 [-0.00049195  0.00049195]
 [-0.00045488  0.00045488]
 [-0.00046479  0.00046479]
 [-0.00047993  0.00047993]
 [-0.00049335  0.00049335]
 [-0.00046682  0.00046682]
 [-0.00044471  0.00044471]
 [-0.00041065  0.00041065]
 [-0.00050037  0.00050037]
 [-0.00050727  0.00050727]
 [-0.00042719  0.00042719]
 [-0.00041441  0.00041441]
 [-0.00042538  0.00042538]
 [-0.00049626  0.00049626]
 [-0.00043333  0.00043333]
 [-0.00046196  0.00046196]
 [-0.00042424  0.00042424]
 [-0.00048281  0.00048281]
 [-0.00042024  0.00042024]
 [-0.00047552  0.00047552]
 [-0.00039529  0.00039529]
 [-0.0004832   0.0004832 ]
 [-0.00041251  0.00041251]
 [-0.00046933  0.00046933]
 [-0.00036029  0.00036029]
 [-0.0004385   0.0004385 ]
 [-0.00040214  0.00040214]
 [-0.00042232  0.00042232]
 [-0.00052142  0.00052142]
 [-0.00051179  0.00051179]
 [-0.00047185  0.00047185]
 [-0.00045588  0.00045588]
 [-0.00049276  0.00049276]
 [-0.00046095  0.00046095]
 [-0.00038893  0.00038893]
 [-0.00048235  0.00048235]
 [-0.0004518   0.0004518 ]
 [-0.00049071  0.00049071]
 [-0.00043122  0.00043122]
 [-0.0004172   0.0004172 ]
 [-0.00041633  0.00041633]
 [-0.00039405  0.00039405]
 [-0.00042748  0.00042748]
 [-0.00039225  0.00039225]
 [-0.00039008  0.00039008]
 [-0.00052648  0.00052648]
 [-0.00044038  0.00044038]
 [-0.00042604  0.00042604]
 [-0.0003942   0.0003942 ]
 [-0.0005609   0.0005609 ]
 [-0.00041837  0.00041837]
 [-0.00041539  0.00041539]
 [-0.00048441  0.00048441]
 [-0.00051419  0.00051419]
 [-0.00040579  0.00040579]
 [-0.00036856  0.00036856]
 [-0.00043531  0.00043531]
 [-0.00041839  0.00041839]
 [-0.00043907  0.00043907]
 [-0.00041038  0.00041038]
 [-0.00041166  0.00041166]
 [-0.00045693  0.00045693]
 [-0.00055583  0.00055583]
 [-0.00042455  0.00042455]
 [-0.00044225  0.00044225]
 [-0.00049807  0.00049807]
 [-0.00041327  0.00041327]
 [-0.00040176  0.00040176]
 [-0.00046058  0.00046058]
 [-0.00035498  0.00035498]
 [-0.00043235  0.00043235]
 [-0.00043656  0.00043656]
 [-0.00044006  0.00044006]
 [-0.00040829  0.00040829]
 [-0.00045427  0.00045427]
 [-0.00050883  0.00050883]
 [-0.0004354   0.0004354 ]
 [-0.00047897  0.00047897]
 [-0.0005358   0.0005358 ]
 [-0.00037739  0.00037739]
 [-0.0004577   0.0004577 ]
 [-0.00050757  0.00050757]
 [-0.00045393  0.00045393]
 [-0.00042307  0.00042307]
 [-0.00042346  0.00042346]
 [-0.00046814  0.00046814]
 [-0.00043288  0.00043288]
 [-0.00049555  0.00049555]
 [-0.00047489  0.00047489]
 [-0.0004563   0.0004563 ]
 [-0.00038884  0.00038884]
 [-0.00050779  0.00050779]
 [-0.00042569  0.00042569]
 [-0.00050727  0.00050727]
 [-0.00042221  0.00042221]
 [-0.00048798  0.00048798]
 [-0.00038153  0.00038153]
 [-0.00038193  0.00038193]
 [-0.00050556  0.00050556]
 [-0.00044277  0.00044277]
 [-0.00042677  0.00042677]
 [-0.00042652  0.00042652]
 [-0.00046324  0.00046324]
 [-0.00041675  0.00041675]
 [-0.00043624  0.00043624]
 [-0.00041689  0.00041689]
 [-0.0004395   0.0004395 ]
 [-0.00046187  0.00046187]
 [-0.00032464  0.00032464]
 [-0.00045352  0.00045352]
 [-0.00040827  0.00040827]
 [-0.00047297  0.00047297]
 [-0.00040659  0.00040659]
 [-0.00048713  0.00048713]
 [-0.00041552  0.00041552]
 [-0.00044188  0.00044188]
 [-0.00038046  0.00038046]
 [-0.0004546   0.0004546 ]
 [-0.00031448  0.00031448]
 [-0.00044896  0.00044896]
 [-0.00047859  0.00047859]
 [-0.00049319  0.00049319]
 [-0.0004902   0.0004902 ]
 [-0.0004579   0.0004579 ]
 [-0.0004702   0.0004702 ]
 [-0.00044856  0.00044856]
 [-0.00043726  0.00043726]
 [-0.00042889  0.00042889]
 [-0.00043149  0.00043149]
 [-0.00045954  0.00045954]
 [-0.00054075  0.00054075]
 [-0.0004304   0.0004304 ]
 [-0.00047098  0.00047098]
 [-0.00052615  0.00052615]
 [-0.00042229  0.00042229]
 [-0.00040349  0.00040349]
 [-0.00043917  0.00043917]
 [-0.00039484  0.00039484]
 [-0.00040305  0.00040305]
 [-0.0004266   0.0004266 ]
 [-0.00039387  0.00039387]
 [-0.00038852  0.00038852]
 [-0.00043368  0.00043368]
 [-0.00041663  0.00041663]
 [-0.00043149  0.00043149]
 [-0.00046986  0.00046986]
 [-0.0004549   0.0004549 ]
 [-0.00049191  0.00049191]
 [-0.00037031  0.00037031]
 [-0.00036463  0.00036463]
 [-0.00045843  0.00045843]
 [-0.00044908  0.00044908]
 [-0.00041787  0.00041787]
 [-0.00046675  0.00046675]
 [-0.00048634  0.00048634]
 [-0.00044427  0.00044427]
 [-0.00051416  0.00051416]
 [-0.00044447  0.00044447]
 [-0.00048449  0.00048449]
 [-0.00034248  0.00034248]
 [-0.00044964  0.00044964]
 [-0.00036735  0.00036735]
 [-0.00040576  0.00040576]
 [-0.00033102  0.00033102]
 [-0.00044897  0.00044897]
 [-0.00044097  0.00044097]
 [-0.00042478  0.00042478]
 [-0.00044462  0.00044462]
 [-0.00048844  0.00048844]
 [-0.00035132  0.00035132]
 [-0.00049156  0.00049156]
 [-0.00047901  0.00047901]
 [-0.0005288   0.0005288 ]
 [-0.00045377  0.00045377]
 [-0.00039024  0.00039024]
 [-0.00053268  0.00053268]
 [-0.00043837  0.00043837]
 [-0.00038022  0.00038022]
 [-0.00042473  0.00042473]
 [-0.00043936  0.00043936]
 [-0.00043346  0.00043346]
 [-0.00042802  0.00042802]
 [-0.00038537  0.00038537]
 [-0.00046897  0.00046897]
 [-0.00048422  0.00048422]
 [-0.00043427  0.00043427]
 [-0.00045943  0.00045943]
 [-0.00044205  0.00044205]
 [-0.00042513  0.00042513]
 [-0.00050946  0.00050946]
 [-0.00049519  0.00049519]
 [-0.00048405  0.00048405]
 [-0.00041417  0.00041417]
 [-0.00045383  0.00045383]
 [-0.00041371  0.00041371]
 [-0.00040474  0.00040474]
 [-0.00042992  0.00042992]
 [-0.00042878  0.00042878]
 [-0.00046164  0.00046164]
 [-0.00043492  0.00043492]
 [-0.00044479  0.00044479]
 [-0.00043146  0.00043146]
 [-0.00042688  0.00042688]
 [-0.00047531  0.00047531]
 [-0.00043626  0.00043626]
 [-0.00042295  0.00042295]
 [-0.00044795  0.00044795]
 [-0.00045116  0.00045116]
 [-0.0003935   0.0003935 ]
 [-0.00044098  0.00044098]
 [-0.00042189  0.00042189]
 [-0.0004365   0.0004365 ]
 [-0.00043282  0.00043282]
 [-0.00040337  0.00040337]
 [-0.00046703  0.00046703]
 [-0.00045226  0.00045226]
 [-0.00041747  0.00041747]
 [-0.00051451  0.00051451]
 [-0.00036603  0.00036603]
 [-0.0004138   0.0004138 ]
 [-0.00037659  0.00037659]
 [-0.00034935  0.00034935]
 [-0.00055683  0.00055683]
 [-0.00039875  0.00039875]
 [-0.00041101  0.00041101]
 [-0.00045327  0.00045327]
 [-0.00046945  0.00046945]
 [-0.00041442  0.00041442]
 [-0.00038902  0.00038902]
 [-0.00044071  0.00044071]
 [-0.00040859  0.00040859]
 [-0.00048323  0.00048323]
 [-0.00044862  0.00044862]
 [-0.00042396  0.00042396]
 [-0.00044063  0.00044063]
 [-0.00051128  0.00051128]
 [-0.00042386  0.00042386]
 [-0.00049018  0.00049018]
 [-0.00040773  0.00040773]
 [-0.00039879  0.00039879]
 [-0.00045063  0.00045063]
 [-0.00042673  0.00042673]
 [-0.00045476  0.00045476]
 [-0.00039632  0.00039632]
 [-0.00039484  0.00039484]
 [-0.0004162   0.0004162 ]
 [-0.00044156  0.00044156]
 [-0.00044091  0.00044091]
 [-0.00049681  0.00049681]
 [-0.00037469  0.00037469]
 [-0.00038194  0.00038194]
 [-0.00051245  0.00051245]
 [-0.00039596  0.00039596]
 [-0.00036408  0.00036408]
 [-0.00044903  0.00044903]
 [-0.00040345  0.00040345]
 [-0.00040038  0.00040038]
 [-0.00040258  0.00040258]
 [-0.0004786   0.0004786 ]
 [-0.00035978  0.00035978]
 [-0.00046073  0.00046073]
 [-0.00044324  0.00044324]
 [-0.00040567  0.00040567]
 [-0.00048299  0.00048299]
 [-0.00045357  0.00045357]
 [-0.00051119  0.00051119]
 [-0.00045234  0.00045234]
 [-0.00041715  0.00041715]
 [-0.00043312  0.00043312]
 [-0.00045441  0.00045441]
 [-0.00041276  0.00041276]
 [-0.00041414  0.00041414]
 [-0.00037801  0.00037801]
 [-0.00035638  0.00035638]
 [-0.00042746  0.00042746]
 [-0.00046802  0.00046802]
 [-0.0004107   0.0004107 ]
 [-0.0004616   0.0004616 ]
 [-0.00040982  0.00040982]
 [-0.00034065  0.00034065]
 [-0.00040589  0.00040589]
 [-0.00043443  0.00043443]
 [-0.00039572  0.00039572]
 [-0.00043272  0.00043272]
 [-0.00052818  0.00052818]
 [-0.00033811  0.00033811]
 [-0.00041611  0.00041611]
 [-0.00040308  0.00040308]
 [-0.00039088  0.00039088]
 [-0.00041965  0.00041965]
 [-0.00040561  0.00040561]
 [-0.00044506  0.00044506]
 [-0.00038302  0.00038302]
 [-0.00044226  0.00044226]
 [-0.00044909  0.00044909]
 [-0.00043603  0.00043603]
 [-0.00040151  0.00040151]
 [-0.00047607  0.00047607]
 [-0.00044094  0.00044094]
 [-0.00044827  0.00044827]
 [-0.00043647  0.00043647]
 [-0.00043933  0.00043933]
 [-0.00035015  0.00035015]
 [-0.00037584  0.00037584]
 [-0.00042551  0.00042551]
 [-0.00045054  0.00045054]
 [-0.00044276  0.00044276]
 [-0.0004231   0.0004231 ]
 [-0.00047431  0.00047431]
 [-0.00041816  0.00041816]
 [-0.00041682  0.00041682]
 [-0.00037839  0.00037839]
 [-0.00044818  0.00044818]
 [-0.00044817  0.00044817]
 [-0.00033931  0.00033931]
 [-0.000465    0.000465  ]
 [-0.00040328  0.00040328]
 [-0.00041603  0.00041603]
 [-0.0004202   0.0004202 ]
 [-0.00034478  0.00034478]
 [-0.00042117  0.00042117]
 [-0.00047835  0.00047835]
 [-0.00043971  0.00043971]
 [-0.00046598  0.00046598]
 [-0.00043261  0.00043261]
 [-0.0003763   0.0003763 ]
 [-0.00047321  0.00047321]
 [-0.00039598  0.00039599]
 [-0.00047681  0.00047681]
 [-0.0003993   0.0003993 ]
 [-0.00037453  0.00037453]
 [-0.0003918   0.0003918 ]
 [-0.00043267  0.00043267]
 [-0.00041275  0.00041275]
 [-0.00041726  0.00041726]
 [-0.00047415  0.00047415]
 [-0.00049128  0.00049128]
 [-0.00052158  0.00052158]
 [-0.00043763  0.00043763]
 [-0.00055771  0.00055771]
 [-0.00042466  0.00042466]
 [-0.00041048  0.00041048]
 [-0.00040919  0.00040919]
 [-0.00050464  0.00050464]
 [-0.00041514  0.00041514]
 [-0.00041666  0.00041666]
 [-0.00048445  0.00048445]
 [-0.00042718  0.00042718]
 [-0.00042272  0.00042272]
 [-0.00040638  0.00040638]
 [-0.00042942  0.00042942]
 [-0.00044479  0.00044479]
 [-0.00047877  0.00047877]
 [-0.00048232  0.00048232]
 [-0.00055965  0.00055965]
 [-0.00052186  0.00052186]
 [-0.00051591  0.00051591]
 [-0.00041148  0.00041148]
 [-0.00039588  0.00039588]
 [-0.00042714  0.00042714]
 [-0.00039063  0.00039063]
 [-0.00036732  0.00036732]
 [-0.00047117  0.00047117]
 [-0.00047343  0.00047343]
 [-0.00046041  0.00046041]
 [-0.00045282  0.00045282]
 [-0.00043936  0.00043936]
 [-0.00042013  0.00042013]
 [-0.0004177   0.0004177 ]
 [-0.00045276  0.00045276]
 [-0.00045407  0.00045407]
 [-0.00045347  0.00045347]
 [-0.00046195  0.00046195]
 [-0.00049909  0.00049909]]
positive mean=0.0007313828100450337, std=5.7283061323687434e-05
negative mean=0.0006199214840307832, std=6.195613241288811e-05
predicted_label: [0 1 0 0 1]
y: [0 1 0 0 1]
batch_size=1024,class_num=2,acc=0.826172,time_used=0.554010
returning from NormbasedScoring
norm_leak_acc: 0.826171875
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|0|3|NormbasedScoring|None|0.9990543735224586|0.826171875|0.9032732565934382
============ apply_trainable_layer= 1 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/1/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.03 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|1|3|No_Attack|None|0.9985815602836879|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[-0.00016137  0.00016308]
 [-0.00015276  0.00015438]
 [-0.00014836  0.00014994]
 ...
 [-0.00015241  0.00015402]
 [-0.00014582  0.00014736]
 [-0.00015232  0.00015393]]
negative gradients:[[ 0.000212   -0.00021425]
 [ 0.00021516 -0.00021744]
 [ 0.00021147 -0.00021371]
 [ 0.00021024 -0.00021247]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020022 -0.00020234]
 [ 0.00021464 -0.00021691]
 [ 0.00020866 -0.00021087]
 [ 0.00020303 -0.00020519]
 [ 0.00020778 -0.00020998]
 [ 0.00020057 -0.0002027 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020708 -0.00020927]
 [ 0.00021305 -0.00021531]
 [ 0.0002004  -0.00020252]
 [ 0.00020497 -0.00020714]
 [ 0.00020163 -0.00020376]
 [ 0.00021288 -0.00021513]
 [ 0.00020813 -0.00021034]
 [ 0.00019882 -0.00020092]
 [ 0.00020462 -0.00020678]
 [ 0.00019565 -0.00019772]
 [ 0.00020585 -0.00020803]
 [ 0.00020409 -0.00020625]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00021253 -0.00021478]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.000212   -0.00021425]
 [ 0.00020128 -0.00020341]
 [ 0.00020848 -0.00021069]
 [ 0.0002069  -0.00020909]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020884 -0.00021105]
 [ 0.00020567 -0.00020785]
 [ 0.00020989 -0.00021211]
 [ 0.00020901 -0.00021123]
 [ 0.00020954 -0.00021176]
 [ 0.00021147 -0.00021371]
 [ 0.00021534 -0.00021762]
 [ 0.00020708 -0.00020927]
 [ 0.0002113  -0.00021354]
 [ 0.00021182 -0.00021407]
 [ 0.00021305 -0.00021531]
 [ 0.00021692 -0.00021922]
 [ 0.00020585 -0.00020803]
 [ 0.00020426 -0.00020643]
 [ 0.00020356 -0.00020572]
 [ 0.00020303 -0.00020519]
 [ 0.00021305 -0.00021531]
 [ 0.00019864 -0.00020074]
 [ 0.00020673 -0.00020892]
 [ 0.00021639 -0.00021869]
 [ 0.00021552 -0.0002178 ]
 [ 0.00020673 -0.00020892]
 [ 0.00020637 -0.00020856]
 [ 0.00019565 -0.00019772]
 [ 0.00020321 -0.00020536]
 [ 0.00020743 -0.00020963]
 [ 0.00020919 -0.0002114 ]
 [ 0.00020409 -0.00020625]
 [ 0.00019548 -0.00019755]
 [ 0.00020216 -0.0002043 ]
 [ 0.00021253 -0.00021478]
 [ 0.00020884 -0.00021105]
 [ 0.000212   -0.00021425]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020708 -0.00020927]
 [ 0.00020128 -0.00020341]
 [ 0.0002062  -0.00020838]
 [ 0.00021376 -0.00021602]
 [ 0.00021358 -0.00021584]
 [ 0.00020848 -0.00021069]
 [ 0.00019829 -0.00020039]
 [ 0.00021182 -0.00021407]
 [ 0.00020743 -0.00020963]
 [ 0.00020409 -0.00020625]
 [ 0.00019723 -0.00019932]
 [ 0.00021446 -0.00021673]
 [ 0.00020778 -0.00020998]
 [ 0.00020514 -0.00020732]
 [ 0.00020655 -0.00020874]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020971 -0.00021194]
 [ 0.00021341 -0.00021567]
 [ 0.00021639 -0.00021869]
 [ 0.00019618 -0.00019826]
 [ 0.00021094 -0.00021318]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020708 -0.00020927]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021059 -0.00021282]
 [ 0.00019864 -0.00020074]
 [ 0.00020391 -0.00020607]
 [ 0.00021481 -0.00021709]
 [ 0.00019829 -0.00020039]
 [ 0.00020321 -0.00020536]
 [ 0.00020426 -0.00020643]
 [ 0.00020514 -0.00020732]
 [ 0.00021112 -0.00021336]
 [ 0.00020321 -0.00020536]
 [ 0.00021692 -0.00021922]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020936 -0.00021158]
 [ 0.00020532 -0.00020749]
 [ 0.00021534 -0.00021762]
 [ 0.00019917 -0.00020128]
 [ 0.00020585 -0.00020803]
 [ 0.00020514 -0.00020732]
 [ 0.0002055  -0.00020767]
 [ 0.00020725 -0.00020945]
 [ 0.00020479 -0.00020696]
 [ 0.00021147 -0.00021371]
 [ 0.00019794 -0.00020003]
 [ 0.00020145 -0.00020359]
 [ 0.00021534 -0.00021762]
 [ 0.00021411 -0.00021638]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00020936 -0.00021158]
 [ 0.00021376 -0.00021602]
 [ 0.0002113  -0.00021354]
 [ 0.00019811 -0.00020021]
 [ 0.00020286 -0.00020501]
 [ 0.00020532 -0.00020749]
 [ 0.00021218 -0.00021442]
 [ 0.00020884 -0.00021105]
 [ 0.00020936 -0.00021158]
 [ 0.00020954 -0.00021176]
 [ 0.00020514 -0.00020732]
 [ 0.00021288 -0.00021513]
 [ 0.00020831 -0.00021051]
 [ 0.00021182 -0.00021407]
 [ 0.00020303 -0.00020519]
 [ 0.00020585 -0.00020803]
 [ 0.00020796 -0.00021016]
 [ 0.00020954 -0.00021176]
 [ 0.00019934 -0.00020145]
 [ 0.00020022 -0.00020234]
 [ 0.00020233 -0.00020447]
 [ 0.00019864 -0.00020074]
 [ 0.00020813 -0.00021034]
 [ 0.00020954 -0.00021176]
 [ 0.00021481 -0.00021709]
 [ 0.00021165 -0.00021389]
 [ 0.00021464 -0.00021691]
 [ 0.00021112 -0.00021336]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021007 -0.00021229]
 [ 0.00020462 -0.00020678]
 [ 0.000212   -0.00021425]
 [ 0.00020567 -0.00020785]
 [ 0.00021042 -0.00021265]
 [ 0.00019934 -0.00020145]
 [ 0.00021446 -0.00021673]
 [ 0.00020514 -0.00020732]
 [ 0.00021815 -0.00022046]
 [ 0.00020339 -0.00020554]
 [ 0.00021059 -0.00021282]
 [ 0.00020497 -0.00020714]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021323 -0.00021549]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020866 -0.00021087]
 [ 0.0002069  -0.00020909]
 [ 0.00019952 -0.00020163]
 [ 0.000196   -0.00019808]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020303 -0.00020519]
 [ 0.00020655 -0.00020874]
 [ 0.00021657 -0.00021886]
 [ 0.0002004  -0.00020252]
 [ 0.00019987 -0.00020199]
 [ 0.00019723 -0.00019932]
 [ 0.00020286 -0.00020501]
 [ 0.00020989 -0.00021211]
 [ 0.00019671 -0.00019879]
 [ 0.00021692 -0.00021922]
 [ 0.0002127  -0.00021496]
 [ 0.00020233 -0.00020447]
 [ 0.00021464 -0.00021691]
 [ 0.00021481 -0.00021709]
 [ 0.00021094 -0.00021318]
 [ 0.00020989 -0.00021211]
 [ 0.00019776 -0.00019986]
 [ 0.00020848 -0.00021069]
 [ 0.00020321 -0.00020536]
 [ 0.00019882 -0.00020092]
 [ 0.00020936 -0.00021158]
 [ 0.0002062  -0.00020838]
 [ 0.00021147 -0.00021371]
 [ 0.0002018  -0.00020394]
 [ 0.00020426 -0.00020643]
 [ 0.00020286 -0.00020501]
 [ 0.00020901 -0.00021123]
 [ 0.00020321 -0.00020536]
 [ 0.00021481 -0.00021709]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020374 -0.0002059 ]
 [ 0.00019706 -0.00019915]
 [ 0.00020022 -0.00020234]
 [ 0.00020022 -0.00020234]
 [ 0.00019618 -0.00019826]
 [ 0.0002011  -0.00020323]
 [ 0.00020514 -0.00020732]
 [ 0.00020567 -0.00020785]
 [ 0.0002171  -0.0002194 ]
 [ 0.00021745 -0.00021975]
 [ 0.00020198 -0.00020412]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020497 -0.00020714]
 [ 0.00019706 -0.00019915]
 [ 0.00021094 -0.00021318]
 [ 0.00020251 -0.00020465]
 [ 0.00021253 -0.00021478]
 [ 0.00020725 -0.00020945]
 [ 0.00020444 -0.00020661]
 [ 0.00021007 -0.00021229]
 [ 0.00020848 -0.00021069]
 [ 0.00020708 -0.00020927]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.00021094 -0.00021318]
 [ 0.00021042 -0.00021265]
 [ 0.00021094 -0.00021318]
 [ 0.00020409 -0.00020625]
 [ 0.00021639 -0.00021869]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021692 -0.00021922]
 [ 0.00019688 -0.00019897]
 [ 0.00021885 -0.00022117]
 [ 0.00020426 -0.00020643]
 [ 0.00021077 -0.000213  ]
 [ 0.00020479 -0.00020696]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021042 -0.00021265]
 [ 0.0002055  -0.00020767]
 [ 0.00021024 -0.00021247]
 [ 0.00020145 -0.00020359]
 [ 0.00020198 -0.00020412]
 [ 0.00020092 -0.00020305]
 [ 0.00020725 -0.00020945]
 [ 0.00020831 -0.00021051]
 [ 0.00019741 -0.0001995 ]
 [ 0.00020971 -0.00021194]
 [ 0.00020409 -0.00020625]
 [ 0.000212   -0.00021425]
 [ 0.0002113  -0.00021354]
 [ 0.00019671 -0.00019879]
 [ 0.00020743 -0.00020963]
 [ 0.00021288 -0.00021513]
 [ 0.00020743 -0.00020963]
 [ 0.00021147 -0.00021371]
 [ 0.00021182 -0.00021407]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020901 -0.00021123]
 [ 0.00021147 -0.00021371]
 [ 0.00019161 -0.00019364]
 [ 0.00020145 -0.00020359]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00021762 -0.00021993]
 [ 0.00021481 -0.00021709]
 [ 0.00019846 -0.00020057]
 [ 0.00019882 -0.00020092]
 [ 0.00020567 -0.00020785]
 [ 0.00021007 -0.00021229]
 [ 0.0002011  -0.00020323]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020233 -0.00020447]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020444 -0.00020661]
 [ 0.00020128 -0.00020341]
 [ 0.00020426 -0.00020643]
 [ 0.0002062  -0.00020838]
 [ 0.00020057 -0.0002027 ]
 [ 0.00019776 -0.00019986]
 [ 0.00021499 -0.00021727]
 [ 0.00019794 -0.00020003]
 [ 0.00020356 -0.00020572]
 [ 0.00021376 -0.00021602]
 [ 0.0002127  -0.00021496]
 [ 0.00020725 -0.00020945]
 [ 0.0002069  -0.00020909]
 [ 0.00020743 -0.00020963]
 [ 0.00021165 -0.00021389]
 [ 0.0002127  -0.00021496]
 [ 0.0002018  -0.00020394]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00020128 -0.00020341]
 [ 0.00021745 -0.00021975]
 [ 0.00020778 -0.00020998]
 [ 0.00021007 -0.00021229]
 [ 0.00019899 -0.0002011 ]
 [ 0.00021464 -0.00021691]
 [ 0.00021499 -0.00021727]
 [ 0.00020901 -0.00021123]
 [ 0.00020848 -0.00021069]
 [ 0.00020954 -0.00021176]
 [ 0.00021411 -0.00021638]
 [ 0.00020831 -0.00021051]
 [ 0.00020796 -0.00021016]
 [ 0.00021094 -0.00021318]
 [ 0.00020128 -0.00020341]
 [ 0.00020497 -0.00020714]
 [ 0.00021446 -0.00021673]
 [ 0.00021622 -0.00021851]
 [ 0.00021253 -0.00021478]
 [ 0.00019811 -0.00020021]
 [ 0.00021112 -0.00021336]
 [ 0.00021253 -0.00021478]
 [ 0.00020708 -0.00020927]
 [ 0.00021077 -0.000213  ]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00021218 -0.00021442]
 [ 0.0002113  -0.00021354]
 [ 0.00020356 -0.00020572]
 [ 0.00021305 -0.00021531]
 [ 0.00021464 -0.00021691]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020585 -0.00020803]
 [ 0.00020391 -0.00020607]
 [ 0.00021446 -0.00021673]
 [ 0.00020866 -0.00021087]
 [ 0.00020725 -0.00020945]
 [ 0.00020286 -0.00020501]
 [ 0.00020778 -0.00020998]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021024 -0.00021247]
 [ 0.00020602 -0.00020821]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020831 -0.00021051]
 [ 0.0002113  -0.00021354]
 [ 0.00020637 -0.00020856]
 [ 0.00020145 -0.00020359]
 [ 0.00020514 -0.00020732]
 [ 0.00019776 -0.00019986]
 [ 0.00020637 -0.00020856]
 [ 0.00020251 -0.00020465]
 [ 0.00021112 -0.00021336]
 [ 0.00020216 -0.0002043 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020884 -0.00021105]
 [ 0.00021024 -0.00021247]
 [ 0.00021147 -0.00021371]
 [ 0.00020321 -0.00020536]
 [ 0.00020901 -0.00021123]
 [ 0.00020743 -0.00020963]
 [ 0.000196   -0.00019808]
 [ 0.00020198 -0.00020412]
 [ 0.0002069  -0.00020909]
 [ 0.00020567 -0.00020785]
 [ 0.0002069  -0.00020909]
 [ 0.00020796 -0.00021016]
 [ 0.00020778 -0.00020998]
 [ 0.00020145 -0.00020359]
 [ 0.00020655 -0.00020874]
 [ 0.00021604 -0.00021833]
 [ 0.00020198 -0.00020412]
 [ 0.00020901 -0.00021123]
 [ 0.00021569 -0.00021798]
 [ 0.00020936 -0.00021158]
 [ 0.00021024 -0.00021247]
 [ 0.00020409 -0.00020625]
 [ 0.00020848 -0.00021069]
 [ 0.00020444 -0.00020661]
 [ 0.00021112 -0.00021336]
 [ 0.00020655 -0.00020874]
 [ 0.00020637 -0.00020856]
 [ 0.00021165 -0.00021389]
 [ 0.00020848 -0.00021069]
 [ 0.00020989 -0.00021211]
 [ 0.00020708 -0.00020927]
 [ 0.00020884 -0.00021105]
 [ 0.00021534 -0.00021762]
 [ 0.0002011  -0.00020323]
 [ 0.00020409 -0.00020625]
 [ 0.0002018  -0.00020394]
 [ 0.00020391 -0.00020607]
 [ 0.00020444 -0.00020661]
 [ 0.00021604 -0.00021833]
 [ 0.00021112 -0.00021336]
 [ 0.00019846 -0.00020057]
 [ 0.00021288 -0.00021513]
 [ 0.00021042 -0.00021265]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020356 -0.00020572]
 [ 0.00020866 -0.00021087]
 [ 0.0002011  -0.00020323]
 [ 0.00020954 -0.00021176]
 [ 0.00020796 -0.00021016]
 [ 0.00021622 -0.00021851]
 [ 0.00020602 -0.00020821]
 [ 0.0002113  -0.00021354]
 [ 0.00021499 -0.00021727]
 [ 0.00020848 -0.00021069]
 [ 0.00021868 -0.000221  ]
 [ 0.00020831 -0.00021051]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020813 -0.00021034]
 [ 0.00021042 -0.00021265]
 [ 0.00020708 -0.00020927]
 [ 0.0002004  -0.00020252]
 [ 0.00020884 -0.00021105]
 [ 0.00020725 -0.00020945]
 [ 0.00020321 -0.00020536]
 [ 0.00019214 -0.00019417]
 [ 0.0002018  -0.00020394]
 [ 0.00020444 -0.00020661]
 [ 0.00020919 -0.0002114 ]
 [ 0.00021042 -0.00021265]
 [ 0.00021323 -0.00021549]
 [ 0.00019618 -0.00019826]
 [ 0.00020409 -0.00020625]
 [ 0.00020321 -0.00020536]
 [ 0.00020919 -0.0002114 ]
 [ 0.0002011  -0.00020323]
 [ 0.00021358 -0.00021584]
 [ 0.00020831 -0.00021051]
 [ 0.00021569 -0.00021798]
 [ 0.00020813 -0.00021034]
 [ 0.00020971 -0.00021194]
 [ 0.00020567 -0.00020785]
 [ 0.00020725 -0.00020945]
 [ 0.00020233 -0.00020447]
 [ 0.0002055  -0.00020767]
 [ 0.00020286 -0.00020501]
 [ 0.00019846 -0.00020057]
 [ 0.00020479 -0.00020696]
 [ 0.00020339 -0.00020554]
 [ 0.00020901 -0.00021123]
 [ 0.00020919 -0.0002114 ]
 [ 0.00019987 -0.00020199]
 [ 0.00020936 -0.00021158]
 [ 0.00021464 -0.00021691]
 [ 0.00020286 -0.00020501]
 [ 0.00020514 -0.00020732]
 [ 0.00020971 -0.00021194]
 [ 0.00020251 -0.00020465]
 [ 0.00020831 -0.00021051]
 [ 0.00020532 -0.00020749]
 [ 0.00021411 -0.00021638]
 [ 0.00021077 -0.000213  ]
 [ 0.00021604 -0.00021833]
 [ 0.00020321 -0.00020536]
 [ 0.00021411 -0.00021638]
 [ 0.00021182 -0.00021407]
 [ 0.00020954 -0.00021176]
 [ 0.00020971 -0.00021194]
 [ 0.00020514 -0.00020732]
 [ 0.00020585 -0.00020803]
 [ 0.00020005 -0.00020217]
 [ 0.00019987 -0.00020199]
 [ 0.00020022 -0.00020234]]
positive mean=0.00021355401258915663, std=7.162120709836017e-06
negative mean=0.0002946807653643191, std=7.565464784420328e-06
predicted_label: [1 0 0 0 1]
y: [0 1 1 1 0]
batch_size=1024,class_num=2,acc=0.000000,time_used=0.106481
returning from NormbasedScoring
norm_leak_acc: 0.0
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|1|3|NormbasedScoring|None|0.9985815602836879|0.0|0.0
================= iter seed  98  =================
===== No Defense ======
running on cuda0
============ apply_trainable_layer= 0 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/0/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.01 train_acc:1.00 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|0|3|No_Attack|None|0.9995271867612293|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
init pos_idx: 510 tensor(0, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 514
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[ 0.0004658  -0.0004658 ]
 [ 0.00046983 -0.00046983]
 [ 0.00041697 -0.00041697]
 ...
 [ 0.00043306 -0.00043306]
 [ 0.00037472 -0.00037472]
 [ 0.00042044 -0.00042044]]
negative gradients:[[-0.00050337  0.00050337]
 [-0.00057806  0.00057806]
 [-0.00050011  0.00050011]
 [-0.00053081  0.00053081]
 [-0.0005361   0.0005361 ]
 [-0.00057159  0.00057159]
 [-0.00056887  0.00056887]
 [-0.00044928  0.00044928]
 [-0.00047654  0.00047654]
 [-0.00052684  0.00052684]
 [-0.00050521  0.00050521]
 [-0.00048726  0.00048726]
 [-0.00058125  0.00058125]
 [-0.00066807  0.00066807]
 [-0.00050784  0.00050784]
 [-0.00048521  0.00048521]
 [-0.00048704  0.00048704]
 [-0.00057108  0.00057108]
 [-0.00054559  0.00054559]
 [-0.00052493  0.00052493]
 [-0.00066621  0.00066621]
 [-0.00043934  0.00043934]
 [-0.00044547  0.00044547]
 [-0.00052515  0.00052515]
 [-0.00055445  0.00055445]
 [-0.00058121  0.00058121]
 [-0.00050491  0.00050491]
 [-0.00043119  0.00043119]
 [-0.00047669  0.00047669]
 [-0.00060372  0.00060372]
 [-0.00053674  0.00053674]
 [-0.00053032  0.00053032]
 [-0.00041171  0.00041171]
 [-0.00048605  0.00048605]
 [-0.00042376  0.00042376]
 [-0.00049803  0.00049803]
 [-0.00053685  0.00053685]
 [-0.00056234  0.00056234]
 [-0.000472    0.000472  ]
 [-0.00051066  0.00051066]
 [-0.00045465  0.00045465]
 [-0.00060736  0.00060736]
 [-0.00055156  0.00055156]
 [-0.00058093  0.00058093]
 [-0.00055284  0.00055284]
 [-0.00043967  0.00043967]
 [-0.00039883  0.00039883]
 [-0.0005289   0.0005289 ]
 [-0.00045784  0.00045784]
 [-0.00049413  0.00049413]
 [-0.00055868  0.00055868]
 [-0.00053592  0.00053592]
 [-0.00054102  0.00054102]
 [-0.00040698  0.00040698]
 [-0.00056837  0.00056837]
 [-0.00060244  0.00060244]
 [-0.00056093  0.00056093]
 [-0.00049691  0.00049691]
 [-0.00053842  0.00053842]
 [-0.00059501  0.00059501]
 [-0.00040651  0.00040651]
 [-0.00050424  0.00050424]
 [-0.00045957  0.00045957]
 [-0.00044103  0.00044103]
 [-0.00052436  0.00052436]
 [-0.00053695  0.00053695]
 [-0.00047445  0.00047445]
 [-0.00050472  0.00050472]
 [-0.00051613  0.00051613]
 [-0.0004902   0.0004902 ]
 [-0.00050557  0.00050557]
 [-0.00059832  0.00059832]
 [-0.00064896  0.00064896]
 [-0.0005333   0.0005333 ]
 [-0.00047775  0.00047775]
 [-0.00038671  0.00038671]
 [-0.00053555  0.00053555]
 [-0.00051446  0.00051446]
 [-0.0005063   0.0005063 ]
 [-0.00055699  0.00055699]
 [-0.00052377  0.00052377]
 [-0.00057852  0.00057852]
 [-0.00057954  0.00057954]
 [-0.00059052  0.00059052]
 [-0.00046218  0.00046218]
 [-0.00047266  0.00047266]
 [-0.00058421  0.00058421]
 [-0.00050871  0.00050871]
 [-0.00049872  0.00049872]
 [-0.00041949  0.00041949]
 [-0.00036338  0.00036338]
 [-0.00062896  0.00062896]
 [-0.00049294  0.00049294]
 [-0.00050161  0.00050161]
 [-0.00046282  0.00046282]
 [-0.00046159  0.00046159]
 [-0.00055657  0.00055657]
 [-0.00049443  0.00049443]
 [-0.00069525  0.00069525]
 [-0.00066062  0.00066062]
 [-0.00052058  0.00052058]
 [-0.00053486  0.00053486]
 [-0.0005237   0.0005237 ]
 [-0.00043699  0.00043699]
 [-0.00056781  0.00056781]
 [-0.0005658   0.0005658 ]
 [-0.00051211  0.00051211]
 [-0.00041518  0.00041518]
 [-0.00048607  0.00048607]
 [-0.00055225  0.00055225]
 [-0.00057213  0.00057213]
 [-0.00060425  0.00060425]
 [-0.00043948  0.00043948]
 [-0.00061719  0.00061719]
 [-0.00057787  0.00057787]
 [-0.00058317  0.00058317]
 [-0.00053629  0.00053629]
 [-0.00045103  0.00045103]
 [-0.00045536  0.00045536]
 [-0.00045614  0.00045614]
 [-0.00055123  0.00055123]
 [-0.00051739  0.00051739]
 [-0.00042718  0.00042718]
 [-0.00063352  0.00063352]
 [-0.00045138  0.00045138]
 [-0.000527    0.000527  ]
 [-0.00047767  0.00047767]
 [-0.00055078  0.00055078]
 [-0.00050706  0.00050706]
 [-0.00054447  0.00054447]
 [-0.00053395  0.00053395]
 [-0.00049838  0.00049838]
 [-0.00053223  0.00053223]
 [-0.00045895  0.00045895]
 [-0.00046261  0.00046261]
 [-0.00053716  0.00053716]
 [-0.00042473  0.00042473]
 [-0.00053233  0.00053233]
 [-0.00060885  0.00060885]
 [-0.00063798  0.00063798]
 [-0.00059274  0.00059274]
 [-0.00058066  0.00058066]
 [-0.00041028  0.00041028]
 [-0.00051233  0.00051233]
 [-0.00044774  0.00044774]
 [-0.00052056  0.00052056]
 [-0.00044945  0.00044945]
 [-0.00058157  0.00058157]
 [-0.00040435  0.00040435]
 [-0.00044089  0.00044089]
 [-0.0005214   0.0005214 ]
 [-0.00045487  0.00045487]
 [-0.00058867  0.00058867]
 [-0.00058649  0.00058649]
 [-0.00052183  0.00052183]
 [-0.00032806  0.00032806]
 [-0.0005543   0.0005543 ]
 [-0.00064196  0.00064196]
 [-0.00055717  0.00055717]
 [-0.00050707  0.00050707]
 [-0.00055565  0.00055565]
 [-0.00056234  0.00056234]
 [-0.00050192  0.00050192]
 [-0.00048515  0.00048515]
 [-0.00036907  0.00036907]
 [-0.00057977  0.00057977]
 [-0.00050798  0.00050798]
 [-0.00048433  0.00048433]
 [-0.00043839  0.00043839]
 [-0.0005586   0.0005586 ]
 [-0.00046616  0.00046616]
 [-0.00057585  0.00057585]
 [-0.00049086  0.00049086]
 [-0.00048825  0.00048825]
 [-0.00053331  0.00053331]
 [-0.00049824  0.00049824]
 [-0.00057327  0.00057327]
 [-0.000579    0.000579  ]
 [-0.00050355  0.00050355]
 [-0.00043045  0.00043045]
 [-0.00045351  0.00045351]
 [-0.0004218   0.0004218 ]
 [-0.00055706  0.00055706]
 [-0.00058028  0.00058028]
 [-0.00066626  0.00066626]
 [-0.00053625  0.00053625]
 [-0.00055538  0.00055538]
 [-0.00046867  0.00046867]
 [-0.00052223  0.00052223]
 [-0.00038166  0.00038166]
 [-0.00053106  0.00053106]
 [-0.00051939  0.00051939]
 [-0.0005232   0.0005232 ]
 [-0.0005119   0.0005119 ]
 [-0.0005014   0.0005014 ]
 [-0.00040017  0.00040017]
 [-0.00045895  0.00045895]
 [-0.00049428  0.00049428]
 [-0.00051307  0.00051307]
 [-0.00056315  0.00056315]
 [-0.00056283  0.00056283]
 [-0.00061144  0.00061144]
 [-0.00050909  0.00050909]
 [-0.00055863  0.00055863]
 [-0.00051871  0.00051871]
 [-0.00049113  0.00049113]
 [-0.00037387  0.00037387]
 [-0.00035318  0.00035318]
 [-0.00060348  0.00060348]
 [-0.00047753  0.00047753]
 [-0.00047893  0.00047893]
 [-0.00040275  0.00040275]
 [-0.00055903  0.00055903]
 [-0.00047437  0.00047437]
 [-0.00054799  0.00054799]
 [-0.00052233  0.00052233]
 [-0.00047123  0.00047123]
 [-0.00043592  0.00043592]
 [-0.00054764  0.00054764]
 [-0.00056617  0.00056617]
 [-0.0005426   0.0005426 ]
 [-0.00044874  0.00044874]
 [-0.00038756  0.00038756]
 [-0.00053958  0.00053958]
 [-0.00056728  0.00056728]
 [-0.00051996  0.00051996]
 [-0.00058413  0.00058413]
 [-0.00051449  0.00051449]
 [-0.00050377  0.00050377]
 [-0.0005033   0.0005033 ]
 [-0.0006349   0.0006349 ]
 [-0.00049631  0.00049631]
 [-0.0005771   0.0005771 ]
 [-0.00050858  0.00050858]
 [-0.00050878  0.00050878]
 [-0.00056866  0.00056866]
 [-0.00037302  0.00037302]
 [-0.00056035  0.00056035]
 [-0.00047158  0.00047158]
 [-0.00047286  0.00047286]
 [-0.00054778  0.00054778]
 [-0.0005537   0.0005537 ]
 [-0.00052676  0.00052676]
 [-0.00058842  0.00058842]
 [-0.00045311  0.00045311]
 [-0.00056929  0.00056929]
 [-0.00053429  0.00053429]
 [-0.00051195  0.00051195]
 [-0.00059413  0.00059413]
 [-0.00061777  0.00061777]
 [-0.00058842  0.00058842]
 [-0.00050042  0.00050042]
 [-0.00051361  0.00051361]
 [-0.0005383   0.0005383 ]
 [-0.00051321  0.00051321]
 [-0.00055442  0.00055442]
 [-0.00046038  0.00046038]
 [-0.00061596  0.00061596]
 [-0.00054756  0.00054756]
 [-0.00056881  0.00056881]
 [-0.00051177  0.00051177]
 [-0.00061198  0.00061198]
 [-0.00057183  0.00057183]
 [-0.00052019  0.00052019]
 [-0.00049145  0.00049145]
 [-0.00042521  0.00042521]
 [-0.00049782  0.00049782]
 [-0.00049745  0.00049745]
 [-0.00050832  0.00050832]
 [-0.00054527  0.00054527]
 [-0.00053463  0.00053463]
 [-0.00041061  0.00041061]
 [-0.00049253  0.00049253]
 [-0.0004901   0.0004901 ]
 [-0.00055719  0.00055719]
 [-0.00048885  0.00048885]
 [-0.00061917  0.00061917]
 [-0.00046301  0.00046301]
 [-0.00052074  0.00052074]
 [-0.00055994  0.00055994]
 [-0.00053624  0.00053624]
 [-0.00047179  0.00047179]
 [-0.00051263  0.00051263]
 [-0.00054297  0.00054297]
 [-0.00048245  0.00048245]
 [-0.00049069  0.00049069]
 [-0.00054432  0.00054432]
 [-0.00045432  0.00045432]
 [-0.00052628  0.00052628]
 [-0.00046271  0.00046271]
 [-0.0005488   0.0005488 ]
 [-0.00055624  0.00055624]
 [-0.00045271  0.00045271]
 [-0.0003913   0.0003913 ]
 [-0.00055362  0.00055362]
 [-0.00055871  0.00055871]
 [-0.00060348  0.00060348]
 [-0.00049106  0.00049106]
 [-0.0005364   0.0005364 ]
 [-0.00060723  0.00060723]
 [-0.00044814  0.00044814]
 [-0.00058938  0.00058938]
 [-0.00046265  0.00046265]
 [-0.00042203  0.00042203]
 [-0.00046726  0.00046726]
 [-0.00049245  0.00049245]
 [-0.00059147  0.00059147]
 [-0.00053796  0.00053796]
 [-0.00052576  0.00052576]
 [-0.00051857  0.00051857]
 [-0.00049912  0.00049912]
 [-0.00050235  0.00050235]
 [-0.00060569  0.00060569]
 [-0.00055655  0.00055655]
 [-0.00048943  0.00048943]
 [-0.00051131  0.00051131]
 [-0.0004936   0.0004936 ]
 [-0.00052426  0.00052426]
 [-0.00049795  0.00049795]
 [-0.00050224  0.00050224]
 [-0.00055857  0.00055857]
 [-0.00045439  0.00045439]
 [-0.00049257  0.00049257]
 [-0.00044908  0.00044908]
 [-0.00051474  0.00051474]
 [-0.00050753  0.00050753]
 [-0.00051645  0.00051645]
 [-0.00051711  0.00051711]
 [-0.00047638  0.00047638]
 [-0.00045272  0.00045272]
 [-0.00056682  0.00056682]
 [-0.00055279  0.00055279]
 [-0.00049352  0.00049352]
 [-0.00056979  0.00056979]
 [-0.00045508  0.00045508]
 [-0.00032905  0.00032905]
 [-0.00060084  0.00060084]
 [-0.00053545  0.00053545]
 [-0.00050528  0.00050528]
 [-0.00046559  0.00046559]
 [-0.00055702  0.00055702]
 [-0.00043843  0.00043843]
 [-0.00051544  0.00051544]
 [-0.00051405  0.00051405]
 [-0.00043486  0.00043486]
 [-0.00053683  0.00053683]
 [-0.00050457  0.00050457]
 [-0.00054729  0.00054729]
 [-0.00053061  0.00053061]
 [-0.00049806  0.00049806]
 [-0.00046507  0.00046507]
 [-0.00056572  0.00056572]
 [-0.00050607  0.00050607]
 [-0.00045876  0.00045876]
 [-0.00047958  0.00047958]
 [-0.00046631  0.00046631]
 [-0.00036379  0.00036379]
 [-0.00057716  0.00057716]
 [-0.00050426  0.00050426]
 [-0.00049417  0.00049417]
 [-0.00050097  0.00050097]
 [-0.00044015  0.00044015]
 [-0.00048269  0.00048269]
 [-0.00044308  0.00044308]
 [-0.00059394  0.00059394]
 [-0.0005271   0.0005271 ]
 [-0.00046961  0.00046961]
 [-0.00051575  0.00051575]
 [-0.00046963  0.00046963]
 [-0.00047468  0.00047468]
 [-0.00041054  0.00041054]
 [-0.00051281  0.00051281]
 [-0.00048291  0.00048291]
 [-0.00057093  0.00057093]
 [-0.00036376  0.00036376]
 [-0.00049811  0.00049811]
 [-0.00049795  0.00049795]
 [-0.00052628  0.00052628]
 [-0.00045642  0.00045642]
 [-0.00044577  0.00044577]
 [-0.00052047  0.00052047]
 [-0.00039117  0.00039117]
 [-0.00043387  0.00043387]
 [-0.00047635  0.00047635]
 [-0.00054103  0.00054103]
 [-0.00067211  0.00067211]
 [-0.00053235  0.00053235]
 [-0.00048964  0.00048964]
 [-0.00058339  0.00058339]
 [-0.00055304  0.00055304]
 [-0.00051126  0.00051126]
 [-0.00050521  0.00050521]
 [-0.0005009   0.0005009 ]
 [-0.00052913  0.00052913]
 [-0.0004624   0.0004624 ]
 [-0.0004953   0.0004953 ]
 [-0.00047752  0.00047752]
 [-0.00047236  0.00047236]
 [-0.00041912  0.00041912]
 [-0.0005495   0.0005495 ]
 [-0.00042906  0.00042906]
 [-0.00047111  0.00047111]
 [-0.00052218  0.00052218]
 [-0.00052121  0.00052121]
 [-0.00051962  0.00051962]
 [-0.00052874  0.00052874]
 [-0.00043539  0.00043539]
 [-0.00046963  0.00046963]
 [-0.00054313  0.00054313]
 [-0.00052213  0.00052213]
 [-0.00050242  0.00050242]
 [-0.00054694  0.00054694]
 [-0.00053957  0.00053957]
 [-0.00049135  0.00049135]
 [-0.00042876  0.00042876]
 [-0.00054112  0.00054112]
 [-0.00046238  0.00046238]
 [-0.00060609  0.00060609]
 [-0.00047836  0.00047836]
 [-0.00055944  0.00055944]
 [-0.00043121  0.00043121]
 [-0.00048452  0.00048452]
 [-0.00050307  0.00050307]
 [-0.00054779  0.00054779]
 [-0.00049798  0.00049798]
 [-0.00047547  0.00047547]
 [-0.00050681  0.00050681]
 [-0.00054519  0.00054519]
 [-0.00051812  0.00051812]
 [-0.00048532  0.00048532]
 [-0.00053406  0.00053406]
 [-0.00054024  0.00054024]
 [-0.00048702  0.00048702]
 [-0.00047243  0.00047243]
 [-0.00054828  0.00054828]
 [-0.00046703  0.00046703]
 [-0.00048828  0.00048828]
 [-0.00048319  0.00048319]
 [-0.0004727   0.0004727 ]
 [-0.00053752  0.00053752]
 [-0.00058213  0.00058213]
 [-0.00055993  0.00055993]
 [-0.00055316  0.00055316]
 [-0.00044379  0.00044379]
 [-0.00040656  0.00040656]
 [-0.00049023  0.00049023]
 [-0.00053606  0.00053606]
 [-0.000593    0.000593  ]
 [-0.00056594  0.00056594]
 [-0.00049244  0.00049244]
 [-0.00060396  0.00060396]
 [-0.00058399  0.00058399]
 [-0.00043146  0.00043146]
 [-0.00054376  0.00054376]
 [-0.00053845  0.00053845]
 [-0.0003828   0.0003828 ]
 [-0.00048691  0.00048691]
 [-0.00052333  0.00052333]
 [-0.00053314  0.00053314]
 [-0.00053401  0.00053401]
 [-0.0005525   0.0005525 ]
 [-0.00042302  0.00042302]
 [-0.00055047  0.00055047]
 [-0.00062399  0.00062399]
 [-0.00048273  0.00048273]
 [-0.00046953  0.00046953]
 [-0.0004703   0.0004703 ]
 [-0.00063754  0.00063754]
 [-0.00052665  0.00052665]
 [-0.00038639  0.00038639]
 [-0.00056689  0.00056689]
 [-0.0005314   0.0005314 ]
 [-0.00055288  0.00055288]
 [-0.00047439  0.00047439]
 [-0.00055327  0.00055327]
 [-0.00062492  0.00062492]
 [-0.00057793  0.00057793]
 [-0.00058094  0.00058094]
 [-0.00060358  0.00060358]
 [-0.00049565  0.00049565]
 [-0.00045536  0.00045536]
 [-0.0004654   0.0004654 ]
 [-0.00045249  0.00045249]
 [-0.00052419  0.00052419]
 [-0.00052435  0.00052435]
 [-0.00052868  0.00052868]]
positive mean=0.0006048058276064694, std=5.9738576965173706e-05
negative mean=0.000725624558981508, std=8.417108620051295e-05
predicted_label: [0 0 0 1 0]
y: [1 1 1 0 1]
batch_size=1024,class_num=2,acc=0.207031,time_used=0.870260
returning from NormbasedScoring
norm_leak_acc: 0.20703125
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|0|3|NormbasedScoring|None|0.9995271867612293|0.20703125|0.11999938807043309
============ apply_trainable_layer= 1 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/1/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.03 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|1|3|No_Attack|None|0.9985815602836879|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[-0.00016137  0.00016308]
 [-0.00015276  0.00015438]
 [-0.00014836  0.00014994]
 ...
 [-0.00015241  0.00015402]
 [-0.00014582  0.00014736]
 [-0.00015232  0.00015393]]
negative gradients:[[ 0.000212   -0.00021425]
 [ 0.00021516 -0.00021744]
 [ 0.00021147 -0.00021371]
 [ 0.00021024 -0.00021247]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020022 -0.00020234]
 [ 0.00021464 -0.00021691]
 [ 0.00020866 -0.00021087]
 [ 0.00020303 -0.00020519]
 [ 0.00020778 -0.00020998]
 [ 0.00020057 -0.0002027 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020708 -0.00020927]
 [ 0.00021305 -0.00021531]
 [ 0.0002004  -0.00020252]
 [ 0.00020497 -0.00020714]
 [ 0.00020163 -0.00020376]
 [ 0.00021288 -0.00021513]
 [ 0.00020813 -0.00021034]
 [ 0.00019882 -0.00020092]
 [ 0.00020462 -0.00020678]
 [ 0.00019565 -0.00019772]
 [ 0.00020585 -0.00020803]
 [ 0.00020409 -0.00020625]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00021253 -0.00021478]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.000212   -0.00021425]
 [ 0.00020128 -0.00020341]
 [ 0.00020848 -0.00021069]
 [ 0.0002069  -0.00020909]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020884 -0.00021105]
 [ 0.00020567 -0.00020785]
 [ 0.00020989 -0.00021211]
 [ 0.00020901 -0.00021123]
 [ 0.00020954 -0.00021176]
 [ 0.00021147 -0.00021371]
 [ 0.00021534 -0.00021762]
 [ 0.00020708 -0.00020927]
 [ 0.0002113  -0.00021354]
 [ 0.00021182 -0.00021407]
 [ 0.00021305 -0.00021531]
 [ 0.00021692 -0.00021922]
 [ 0.00020585 -0.00020803]
 [ 0.00020426 -0.00020643]
 [ 0.00020356 -0.00020572]
 [ 0.00020303 -0.00020519]
 [ 0.00021305 -0.00021531]
 [ 0.00019864 -0.00020074]
 [ 0.00020673 -0.00020892]
 [ 0.00021639 -0.00021869]
 [ 0.00021552 -0.0002178 ]
 [ 0.00020673 -0.00020892]
 [ 0.00020637 -0.00020856]
 [ 0.00019565 -0.00019772]
 [ 0.00020321 -0.00020536]
 [ 0.00020743 -0.00020963]
 [ 0.00020919 -0.0002114 ]
 [ 0.00020409 -0.00020625]
 [ 0.00019548 -0.00019755]
 [ 0.00020216 -0.0002043 ]
 [ 0.00021253 -0.00021478]
 [ 0.00020884 -0.00021105]
 [ 0.000212   -0.00021425]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020708 -0.00020927]
 [ 0.00020128 -0.00020341]
 [ 0.0002062  -0.00020838]
 [ 0.00021376 -0.00021602]
 [ 0.00021358 -0.00021584]
 [ 0.00020848 -0.00021069]
 [ 0.00019829 -0.00020039]
 [ 0.00021182 -0.00021407]
 [ 0.00020743 -0.00020963]
 [ 0.00020409 -0.00020625]
 [ 0.00019723 -0.00019932]
 [ 0.00021446 -0.00021673]
 [ 0.00020778 -0.00020998]
 [ 0.00020514 -0.00020732]
 [ 0.00020655 -0.00020874]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020971 -0.00021194]
 [ 0.00021341 -0.00021567]
 [ 0.00021639 -0.00021869]
 [ 0.00019618 -0.00019826]
 [ 0.00021094 -0.00021318]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020708 -0.00020927]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021059 -0.00021282]
 [ 0.00019864 -0.00020074]
 [ 0.00020391 -0.00020607]
 [ 0.00021481 -0.00021709]
 [ 0.00019829 -0.00020039]
 [ 0.00020321 -0.00020536]
 [ 0.00020426 -0.00020643]
 [ 0.00020514 -0.00020732]
 [ 0.00021112 -0.00021336]
 [ 0.00020321 -0.00020536]
 [ 0.00021692 -0.00021922]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020936 -0.00021158]
 [ 0.00020532 -0.00020749]
 [ 0.00021534 -0.00021762]
 [ 0.00019917 -0.00020128]
 [ 0.00020585 -0.00020803]
 [ 0.00020514 -0.00020732]
 [ 0.0002055  -0.00020767]
 [ 0.00020725 -0.00020945]
 [ 0.00020479 -0.00020696]
 [ 0.00021147 -0.00021371]
 [ 0.00019794 -0.00020003]
 [ 0.00020145 -0.00020359]
 [ 0.00021534 -0.00021762]
 [ 0.00021411 -0.00021638]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00020936 -0.00021158]
 [ 0.00021376 -0.00021602]
 [ 0.0002113  -0.00021354]
 [ 0.00019811 -0.00020021]
 [ 0.00020286 -0.00020501]
 [ 0.00020532 -0.00020749]
 [ 0.00021218 -0.00021442]
 [ 0.00020884 -0.00021105]
 [ 0.00020936 -0.00021158]
 [ 0.00020954 -0.00021176]
 [ 0.00020514 -0.00020732]
 [ 0.00021288 -0.00021513]
 [ 0.00020831 -0.00021051]
 [ 0.00021182 -0.00021407]
 [ 0.00020303 -0.00020519]
 [ 0.00020585 -0.00020803]
 [ 0.00020796 -0.00021016]
 [ 0.00020954 -0.00021176]
 [ 0.00019934 -0.00020145]
 [ 0.00020022 -0.00020234]
 [ 0.00020233 -0.00020447]
 [ 0.00019864 -0.00020074]
 [ 0.00020813 -0.00021034]
 [ 0.00020954 -0.00021176]
 [ 0.00021481 -0.00021709]
 [ 0.00021165 -0.00021389]
 [ 0.00021464 -0.00021691]
 [ 0.00021112 -0.00021336]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021007 -0.00021229]
 [ 0.00020462 -0.00020678]
 [ 0.000212   -0.00021425]
 [ 0.00020567 -0.00020785]
 [ 0.00021042 -0.00021265]
 [ 0.00019934 -0.00020145]
 [ 0.00021446 -0.00021673]
 [ 0.00020514 -0.00020732]
 [ 0.00021815 -0.00022046]
 [ 0.00020339 -0.00020554]
 [ 0.00021059 -0.00021282]
 [ 0.00020497 -0.00020714]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021323 -0.00021549]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020866 -0.00021087]
 [ 0.0002069  -0.00020909]
 [ 0.00019952 -0.00020163]
 [ 0.000196   -0.00019808]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020303 -0.00020519]
 [ 0.00020655 -0.00020874]
 [ 0.00021657 -0.00021886]
 [ 0.0002004  -0.00020252]
 [ 0.00019987 -0.00020199]
 [ 0.00019723 -0.00019932]
 [ 0.00020286 -0.00020501]
 [ 0.00020989 -0.00021211]
 [ 0.00019671 -0.00019879]
 [ 0.00021692 -0.00021922]
 [ 0.0002127  -0.00021496]
 [ 0.00020233 -0.00020447]
 [ 0.00021464 -0.00021691]
 [ 0.00021481 -0.00021709]
 [ 0.00021094 -0.00021318]
 [ 0.00020989 -0.00021211]
 [ 0.00019776 -0.00019986]
 [ 0.00020848 -0.00021069]
 [ 0.00020321 -0.00020536]
 [ 0.00019882 -0.00020092]
 [ 0.00020936 -0.00021158]
 [ 0.0002062  -0.00020838]
 [ 0.00021147 -0.00021371]
 [ 0.0002018  -0.00020394]
 [ 0.00020426 -0.00020643]
 [ 0.00020286 -0.00020501]
 [ 0.00020901 -0.00021123]
 [ 0.00020321 -0.00020536]
 [ 0.00021481 -0.00021709]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020374 -0.0002059 ]
 [ 0.00019706 -0.00019915]
 [ 0.00020022 -0.00020234]
 [ 0.00020022 -0.00020234]
 [ 0.00019618 -0.00019826]
 [ 0.0002011  -0.00020323]
 [ 0.00020514 -0.00020732]
 [ 0.00020567 -0.00020785]
 [ 0.0002171  -0.0002194 ]
 [ 0.00021745 -0.00021975]
 [ 0.00020198 -0.00020412]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020497 -0.00020714]
 [ 0.00019706 -0.00019915]
 [ 0.00021094 -0.00021318]
 [ 0.00020251 -0.00020465]
 [ 0.00021253 -0.00021478]
 [ 0.00020725 -0.00020945]
 [ 0.00020444 -0.00020661]
 [ 0.00021007 -0.00021229]
 [ 0.00020848 -0.00021069]
 [ 0.00020708 -0.00020927]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.00021094 -0.00021318]
 [ 0.00021042 -0.00021265]
 [ 0.00021094 -0.00021318]
 [ 0.00020409 -0.00020625]
 [ 0.00021639 -0.00021869]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021692 -0.00021922]
 [ 0.00019688 -0.00019897]
 [ 0.00021885 -0.00022117]
 [ 0.00020426 -0.00020643]
 [ 0.00021077 -0.000213  ]
 [ 0.00020479 -0.00020696]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021042 -0.00021265]
 [ 0.0002055  -0.00020767]
 [ 0.00021024 -0.00021247]
 [ 0.00020145 -0.00020359]
 [ 0.00020198 -0.00020412]
 [ 0.00020092 -0.00020305]
 [ 0.00020725 -0.00020945]
 [ 0.00020831 -0.00021051]
 [ 0.00019741 -0.0001995 ]
 [ 0.00020971 -0.00021194]
 [ 0.00020409 -0.00020625]
 [ 0.000212   -0.00021425]
 [ 0.0002113  -0.00021354]
 [ 0.00019671 -0.00019879]
 [ 0.00020743 -0.00020963]
 [ 0.00021288 -0.00021513]
 [ 0.00020743 -0.00020963]
 [ 0.00021147 -0.00021371]
 [ 0.00021182 -0.00021407]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020901 -0.00021123]
 [ 0.00021147 -0.00021371]
 [ 0.00019161 -0.00019364]
 [ 0.00020145 -0.00020359]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00021762 -0.00021993]
 [ 0.00021481 -0.00021709]
 [ 0.00019846 -0.00020057]
 [ 0.00019882 -0.00020092]
 [ 0.00020567 -0.00020785]
 [ 0.00021007 -0.00021229]
 [ 0.0002011  -0.00020323]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020233 -0.00020447]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020444 -0.00020661]
 [ 0.00020128 -0.00020341]
 [ 0.00020426 -0.00020643]
 [ 0.0002062  -0.00020838]
 [ 0.00020057 -0.0002027 ]
 [ 0.00019776 -0.00019986]
 [ 0.00021499 -0.00021727]
 [ 0.00019794 -0.00020003]
 [ 0.00020356 -0.00020572]
 [ 0.00021376 -0.00021602]
 [ 0.0002127  -0.00021496]
 [ 0.00020725 -0.00020945]
 [ 0.0002069  -0.00020909]
 [ 0.00020743 -0.00020963]
 [ 0.00021165 -0.00021389]
 [ 0.0002127  -0.00021496]
 [ 0.0002018  -0.00020394]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00020128 -0.00020341]
 [ 0.00021745 -0.00021975]
 [ 0.00020778 -0.00020998]
 [ 0.00021007 -0.00021229]
 [ 0.00019899 -0.0002011 ]
 [ 0.00021464 -0.00021691]
 [ 0.00021499 -0.00021727]
 [ 0.00020901 -0.00021123]
 [ 0.00020848 -0.00021069]
 [ 0.00020954 -0.00021176]
 [ 0.00021411 -0.00021638]
 [ 0.00020831 -0.00021051]
 [ 0.00020796 -0.00021016]
 [ 0.00021094 -0.00021318]
 [ 0.00020128 -0.00020341]
 [ 0.00020497 -0.00020714]
 [ 0.00021446 -0.00021673]
 [ 0.00021622 -0.00021851]
 [ 0.00021253 -0.00021478]
 [ 0.00019811 -0.00020021]
 [ 0.00021112 -0.00021336]
 [ 0.00021253 -0.00021478]
 [ 0.00020708 -0.00020927]
 [ 0.00021077 -0.000213  ]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00021218 -0.00021442]
 [ 0.0002113  -0.00021354]
 [ 0.00020356 -0.00020572]
 [ 0.00021305 -0.00021531]
 [ 0.00021464 -0.00021691]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020585 -0.00020803]
 [ 0.00020391 -0.00020607]
 [ 0.00021446 -0.00021673]
 [ 0.00020866 -0.00021087]
 [ 0.00020725 -0.00020945]
 [ 0.00020286 -0.00020501]
 [ 0.00020778 -0.00020998]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021024 -0.00021247]
 [ 0.00020602 -0.00020821]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020831 -0.00021051]
 [ 0.0002113  -0.00021354]
 [ 0.00020637 -0.00020856]
 [ 0.00020145 -0.00020359]
 [ 0.00020514 -0.00020732]
 [ 0.00019776 -0.00019986]
 [ 0.00020637 -0.00020856]
 [ 0.00020251 -0.00020465]
 [ 0.00021112 -0.00021336]
 [ 0.00020216 -0.0002043 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020884 -0.00021105]
 [ 0.00021024 -0.00021247]
 [ 0.00021147 -0.00021371]
 [ 0.00020321 -0.00020536]
 [ 0.00020901 -0.00021123]
 [ 0.00020743 -0.00020963]
 [ 0.000196   -0.00019808]
 [ 0.00020198 -0.00020412]
 [ 0.0002069  -0.00020909]
 [ 0.00020567 -0.00020785]
 [ 0.0002069  -0.00020909]
 [ 0.00020796 -0.00021016]
 [ 0.00020778 -0.00020998]
 [ 0.00020145 -0.00020359]
 [ 0.00020655 -0.00020874]
 [ 0.00021604 -0.00021833]
 [ 0.00020198 -0.00020412]
 [ 0.00020901 -0.00021123]
 [ 0.00021569 -0.00021798]
 [ 0.00020936 -0.00021158]
 [ 0.00021024 -0.00021247]
 [ 0.00020409 -0.00020625]
 [ 0.00020848 -0.00021069]
 [ 0.00020444 -0.00020661]
 [ 0.00021112 -0.00021336]
 [ 0.00020655 -0.00020874]
 [ 0.00020637 -0.00020856]
 [ 0.00021165 -0.00021389]
 [ 0.00020848 -0.00021069]
 [ 0.00020989 -0.00021211]
 [ 0.00020708 -0.00020927]
 [ 0.00020884 -0.00021105]
 [ 0.00021534 -0.00021762]
 [ 0.0002011  -0.00020323]
 [ 0.00020409 -0.00020625]
 [ 0.0002018  -0.00020394]
 [ 0.00020391 -0.00020607]
 [ 0.00020444 -0.00020661]
 [ 0.00021604 -0.00021833]
 [ 0.00021112 -0.00021336]
 [ 0.00019846 -0.00020057]
 [ 0.00021288 -0.00021513]
 [ 0.00021042 -0.00021265]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020356 -0.00020572]
 [ 0.00020866 -0.00021087]
 [ 0.0002011  -0.00020323]
 [ 0.00020954 -0.00021176]
 [ 0.00020796 -0.00021016]
 [ 0.00021622 -0.00021851]
 [ 0.00020602 -0.00020821]
 [ 0.0002113  -0.00021354]
 [ 0.00021499 -0.00021727]
 [ 0.00020848 -0.00021069]
 [ 0.00021868 -0.000221  ]
 [ 0.00020831 -0.00021051]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020813 -0.00021034]
 [ 0.00021042 -0.00021265]
 [ 0.00020708 -0.00020927]
 [ 0.0002004  -0.00020252]
 [ 0.00020884 -0.00021105]
 [ 0.00020725 -0.00020945]
 [ 0.00020321 -0.00020536]
 [ 0.00019214 -0.00019417]
 [ 0.0002018  -0.00020394]
 [ 0.00020444 -0.00020661]
 [ 0.00020919 -0.0002114 ]
 [ 0.00021042 -0.00021265]
 [ 0.00021323 -0.00021549]
 [ 0.00019618 -0.00019826]
 [ 0.00020409 -0.00020625]
 [ 0.00020321 -0.00020536]
 [ 0.00020919 -0.0002114 ]
 [ 0.0002011  -0.00020323]
 [ 0.00021358 -0.00021584]
 [ 0.00020831 -0.00021051]
 [ 0.00021569 -0.00021798]
 [ 0.00020813 -0.00021034]
 [ 0.00020971 -0.00021194]
 [ 0.00020567 -0.00020785]
 [ 0.00020725 -0.00020945]
 [ 0.00020233 -0.00020447]
 [ 0.0002055  -0.00020767]
 [ 0.00020286 -0.00020501]
 [ 0.00019846 -0.00020057]
 [ 0.00020479 -0.00020696]
 [ 0.00020339 -0.00020554]
 [ 0.00020901 -0.00021123]
 [ 0.00020919 -0.0002114 ]
 [ 0.00019987 -0.00020199]
 [ 0.00020936 -0.00021158]
 [ 0.00021464 -0.00021691]
 [ 0.00020286 -0.00020501]
 [ 0.00020514 -0.00020732]
 [ 0.00020971 -0.00021194]
 [ 0.00020251 -0.00020465]
 [ 0.00020831 -0.00021051]
 [ 0.00020532 -0.00020749]
 [ 0.00021411 -0.00021638]
 [ 0.00021077 -0.000213  ]
 [ 0.00021604 -0.00021833]
 [ 0.00020321 -0.00020536]
 [ 0.00021411 -0.00021638]
 [ 0.00021182 -0.00021407]
 [ 0.00020954 -0.00021176]
 [ 0.00020971 -0.00021194]
 [ 0.00020514 -0.00020732]
 [ 0.00020585 -0.00020803]
 [ 0.00020005 -0.00020217]
 [ 0.00019987 -0.00020199]
 [ 0.00020022 -0.00020234]]
positive mean=0.00021355401258915663, std=7.162120709836017e-06
negative mean=0.0002946807653643191, std=7.565464784420328e-06
predicted_label: [1 0 0 0 1]
y: [0 1 1 1 0]
batch_size=1024,class_num=2,acc=0.000000,time_used=0.092207
returning from NormbasedScoring
norm_leak_acc: 0.0
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|1|3|NormbasedScoring|None|0.9985815602836879|0.0|0.0
================= iter seed  99  =================
===== No Defense ======
running on cuda0
============ apply_trainable_layer= 0 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/0/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.01 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|0|3|No_Attack|None|0.9990543735224586|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
init pos_idx: 510 tensor(0, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 511
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[ 0.00048334 -0.00048334]
 [ 0.00044649 -0.00044649]
 [ 0.00051651 -0.00051651]
 ...
 [ 0.00043572 -0.00043572]
 [ 0.00043256 -0.00043256]
 [ 0.00039195 -0.00039195]]
negative gradients:[[-0.00056103  0.00056103]
 [-0.00055969  0.00055969]
 [-0.00055073  0.00055073]
 [-0.00058004  0.00058004]
 [-0.00062254  0.00062254]
 [-0.00063086  0.00063086]
 [-0.00067456  0.00067456]
 [-0.00056553  0.00056553]
 [-0.00061424  0.00061424]
 [-0.0005644   0.0005644 ]
 [-0.00066256  0.00066256]
 [-0.00065384  0.00065384]
 [-0.00053901  0.00053901]
 [-0.00061767  0.00061767]
 [-0.00056033  0.00056033]
 [-0.0005751   0.0005751 ]
 [-0.00059141  0.00059141]
 [-0.00062983  0.00062983]
 [-0.00058805  0.00058805]
 [-0.00061361  0.00061361]
 [-0.00068515  0.00068515]
 [-0.00061505  0.00061505]
 [-0.00063097  0.00063097]
 [-0.00067131  0.00067131]
 [-0.00061503  0.00061503]
 [-0.00053099  0.00053099]
 [-0.0005177   0.0005177 ]
 [-0.00058763  0.00058763]
 [-0.00057515  0.00057515]
 [-0.00059836  0.00059836]
 [-0.00055439  0.00055439]
 [-0.00064374  0.00064374]
 [-0.00047074  0.00047074]
 [-0.00051796  0.00051796]
 [-0.00061918  0.00061918]
 [-0.00049702  0.00049702]
 [-0.00060561  0.00060561]
 [-0.0005785   0.0005785 ]
 [-0.0006172   0.0006172 ]
 [-0.00056791  0.00056791]
 [-0.00057609  0.00057609]
 [-0.00059813  0.00059813]
 [-0.00055836  0.00055836]
 [-0.00055513  0.00055513]
 [-0.00062602  0.00062602]
 [-0.00056077  0.00056077]
 [-0.00062892  0.00062892]
 [-0.0006432   0.0006432 ]
 [-0.00055698  0.00055698]
 [-0.00056901  0.00056901]
 [-0.00056528  0.00056528]
 [-0.0006308   0.0006308 ]
 [-0.00052266  0.00052266]
 [-0.00059825  0.00059825]
 [-0.00061131  0.00061131]
 [-0.00058135  0.00058135]
 [-0.00053494  0.00053494]
 [-0.00061832  0.00061832]
 [-0.00060309  0.00060309]
 [-0.00053817  0.00053817]
 [-0.0005714   0.0005714 ]
 [-0.00049636  0.00049636]
 [-0.00059653  0.00059653]
 [-0.00055611  0.00055611]
 [-0.00066586  0.00066586]
 [-0.00060816  0.00060816]
 [-0.00061966  0.00061966]
 [-0.00053026  0.00053026]
 [-0.00061815  0.00061815]
 [-0.00058701  0.00058701]
 [-0.00059023  0.00059023]
 [-0.0005809   0.0005809 ]
 [-0.00054593  0.00054593]
 [-0.00064098  0.00064098]
 [-0.00053828  0.00053828]
 [-0.00056371  0.00056371]
 [-0.00060039  0.00060039]
 [-0.00062973  0.00062973]
 [-0.000649    0.000649  ]
 [-0.00053162  0.00053162]
 [-0.00060771  0.00060771]
 [-0.00062648  0.00062648]
 [-0.00057952  0.00057952]
 [-0.00060033  0.00060033]
 [-0.00061432  0.00061432]
 [-0.00061319  0.00061319]
 [-0.00050894  0.00050894]
 [-0.00066774  0.00066774]
 [-0.00054816  0.00054816]
 [-0.00058496  0.00058496]
 [-0.00055496  0.00055496]
 [-0.00055449  0.00055449]
 [-0.00062938  0.00062938]
 [-0.00058148  0.00058148]
 [-0.00057681  0.00057681]
 [-0.00047544  0.00047544]
 [-0.00058526  0.00058526]
 [-0.00048509  0.00048509]
 [-0.00061976  0.00061976]
 [-0.00059438  0.00059438]
 [-0.00054786  0.00054786]
 [-0.0006025   0.0006025 ]
 [-0.00064013  0.00064013]
 [-0.00058987  0.00058987]
 [-0.00056217  0.00056217]
 [-0.00062075  0.00062075]
 [-0.00057614  0.00057614]
 [-0.00055503  0.00055503]
 [-0.00056715  0.00056715]
 [-0.00062883  0.00062883]
 [-0.00058189  0.00058189]
 [-0.00065002  0.00065002]
 [-0.00053011  0.00053011]
 [-0.00055498  0.00055498]
 [-0.000575    0.000575  ]
 [-0.00061661  0.00061661]
 [-0.0005806   0.0005806 ]
 [-0.00057549  0.00057549]
 [-0.00058873  0.00058873]
 [-0.00059504  0.00059504]
 [-0.00057098  0.00057098]
 [-0.00057198  0.00057198]
 [-0.00053587  0.00053587]
 [-0.00059561  0.00059561]
 [-0.00063211  0.00063211]
 [-0.0005923   0.0005923 ]
 [-0.00049008  0.00049008]
 [-0.00059456  0.00059456]
 [-0.00060756  0.00060756]
 [-0.00062655  0.00062655]
 [-0.00046581  0.00046581]
 [-0.00059828  0.00059828]
 [-0.0006003   0.0006003 ]
 [-0.00058604  0.00058604]
 [-0.00058258  0.00058258]
 [-0.00062368  0.00062368]
 [-0.00061352  0.00061352]
 [-0.00058749  0.00058749]
 [-0.00058136  0.00058136]
 [-0.00064846  0.00064846]
 [-0.00060258  0.00060258]
 [-0.00053709  0.00053709]
 [-0.00060289  0.00060289]
 [-0.00059728  0.00059728]
 [-0.00058375  0.00058375]
 [-0.00057712  0.00057712]
 [-0.00060958  0.00060958]
 [-0.00058753  0.00058753]
 [-0.00062837  0.00062837]
 [-0.00055521  0.00055521]
 [-0.00057261  0.00057261]
 [-0.00057261  0.00057261]
 [-0.00054373  0.00054373]
 [-0.00055704  0.00055704]
 [-0.00058617  0.00058617]
 [-0.00049784  0.00049784]
 [-0.00063203  0.00063203]
 [-0.00060388  0.00060388]
 [-0.00056827  0.00056827]
 [-0.00061115  0.00061115]
 [-0.00063586  0.00063586]
 [-0.00059169  0.00059169]
 [-0.00065504  0.00065504]
 [-0.00061491  0.00061491]
 [-0.00059586  0.00059586]
 [-0.0005861   0.0005861 ]
 [-0.00062177  0.00062177]
 [-0.00066067  0.00066067]
 [-0.00068288  0.00068288]
 [-0.00057586  0.00057586]
 [-0.00060676  0.00060676]
 [-0.00061153  0.00061153]
 [-0.00061025  0.00061025]
 [-0.00061147  0.00061147]
 [-0.00060475  0.00060475]
 [-0.00053895  0.00053895]
 [-0.00058275  0.00058275]
 [-0.00050546  0.00050546]
 [-0.00056166  0.00056166]
 [-0.00058444  0.00058444]
 [-0.00050404  0.00050404]
 [-0.00054385  0.00054385]
 [-0.00060173  0.00060173]
 [-0.00058443  0.00058443]
 [-0.00060404  0.00060404]
 [-0.00061635  0.00061635]
 [-0.00060655  0.00060655]
 [-0.00060186  0.00060186]
 [-0.00061963  0.00061963]
 [-0.00059944  0.00059944]
 [-0.00061047  0.00061047]
 [-0.00056516  0.00056516]
 [-0.00063594  0.00063594]
 [-0.00054986  0.00054986]
 [-0.00059276  0.00059276]
 [-0.00055142  0.00055142]
 [-0.00056381  0.00056381]
 [-0.00060694  0.00060694]
 [-0.00061247  0.00061247]
 [-0.00052175  0.00052175]
 [-0.00057444  0.00057444]
 [-0.00052559  0.00052559]
 [-0.00065722  0.00065722]
 [-0.00061338  0.00061338]
 [-0.00052028  0.00052028]
 [-0.0006145   0.0006145 ]
 [-0.00057801  0.00057801]
 [-0.0006055   0.0006055 ]
 [-0.00048399  0.00048399]
 [-0.00063087  0.00063087]
 [-0.00057955  0.00057955]
 [-0.00066552  0.00066552]
 [-0.00060617  0.00060617]
 [-0.00059941  0.00059941]
 [-0.00058264  0.00058264]
 [-0.00057633  0.00057633]
 [-0.00054218  0.00054218]
 [-0.00057013  0.00057013]
 [-0.00063508  0.00063508]
 [-0.00053483  0.00053483]
 [-0.00066297  0.00066297]
 [-0.00055968  0.00055968]
 [-0.00064385  0.00064385]
 [-0.00058109  0.00058109]
 [-0.00060252  0.00060252]
 [-0.0004867   0.0004867 ]
 [-0.00059448  0.00059448]
 [-0.00062459  0.00062459]
 [-0.00054331  0.00054331]
 [-0.00055189  0.00055189]
 [-0.00057651  0.00057651]
 [-0.00061975  0.00061975]
 [-0.00056267  0.00056267]
 [-0.00058519  0.00058519]
 [-0.00057461  0.00057461]
 [-0.00052862  0.00052862]
 [-0.0006157   0.0006157 ]
 [-0.00056872  0.00056872]
 [-0.00063984  0.00063984]
 [-0.00054809  0.00054809]
 [-0.00060874  0.00060874]
 [-0.00056507  0.00056507]
 [-0.00059693  0.00059693]
 [-0.00054511  0.00054511]
 [-0.00063193  0.00063193]
 [-0.00053971  0.00053971]
 [-0.00048697  0.00048697]
 [-0.00060341  0.00060341]
 [-0.00052675  0.00052675]
 [-0.00058519  0.00058519]
 [-0.00059621  0.00059621]
 [-0.00063345  0.00063345]
 [-0.0005352   0.0005352 ]
 [-0.00054824  0.00054824]
 [-0.00060705  0.00060705]
 [-0.00060691  0.00060691]
 [-0.00056852  0.00056852]
 [-0.00063241  0.00063241]
 [-0.00060144  0.00060144]
 [-0.00059307  0.00059307]
 [-0.00062913  0.00062913]
 [-0.00056465  0.00056465]
 [-0.00057313  0.00057313]
 [-0.0005436   0.0005436 ]
 [-0.00064148  0.00064148]
 [-0.00056497  0.00056497]
 [-0.00059007  0.00059007]
 [-0.00054799  0.00054799]
 [-0.00064959  0.00064959]
 [-0.00054547  0.00054547]
 [-0.0005943   0.0005943 ]
 [-0.00059753  0.00059753]
 [-0.00058328  0.00058328]
 [-0.00057486  0.00057486]
 [-0.00056122  0.00056122]
 [-0.00057209  0.00057209]
 [-0.0006085   0.0006085 ]
 [-0.00053518  0.00053518]
 [-0.00049714  0.00049714]
 [-0.00056987  0.00056987]
 [-0.00046577  0.00046577]
 [-0.00058529  0.00058529]
 [-0.00060005  0.00060005]
 [-0.0005904   0.0005904 ]
 [-0.00060781  0.00060781]
 [-0.00048603  0.00048603]
 [-0.00055428  0.00055428]
 [-0.00062254  0.00062254]
 [-0.00060775  0.00060775]
 [-0.00062069  0.00062069]
 [-0.00060524  0.00060524]
 [-0.0005136   0.0005136 ]
 [-0.00055753  0.00055753]
 [-0.00062771  0.00062771]
 [-0.00051768  0.00051768]
 [-0.00062829  0.00062829]
 [-0.00056633  0.00056633]
 [-0.00052329  0.00052329]
 [-0.00057815  0.00057815]
 [-0.00056595  0.00056595]
 [-0.00053792  0.00053792]
 [-0.00067484  0.00067484]
 [-0.00064259  0.00064259]
 [-0.00061083  0.00061083]
 [-0.00049499  0.00049499]
 [-0.00058722  0.00058722]
 [-0.00064379  0.00064379]
 [-0.00054673  0.00054673]
 [-0.00054868  0.00054868]
 [-0.0005852   0.0005852 ]
 [-0.00056889  0.00056889]
 [-0.00064931  0.00064931]
 [-0.00063919  0.00063919]
 [-0.00063297  0.00063297]
 [-0.00062915  0.00062915]
 [-0.00048887  0.00048887]
 [-0.00058873  0.00058873]
 [-0.0006482   0.0006482 ]
 [-0.00057362  0.00057362]
 [-0.0006087   0.0006087 ]
 [-0.00062356  0.00062356]
 [-0.00063812  0.00063812]
 [-0.00058917  0.00058917]
 [-0.0005883   0.0005883 ]
 [-0.00060603  0.00060603]
 [-0.00060812  0.00060812]
 [-0.00060569  0.00060569]
 [-0.00059425  0.00059425]
 [-0.00055869  0.00055869]
 [-0.00055303  0.00055303]
 [-0.00058149  0.00058149]
 [-0.00066034  0.00066034]
 [-0.00057645  0.00057645]
 [-0.00061698  0.00061698]
 [-0.00063949  0.00063949]
 [-0.00061035  0.00061035]
 [-0.00064599  0.00064599]
 [-0.00064787  0.00064787]
 [-0.00064626  0.00064626]
 [-0.00060184  0.00060184]
 [-0.00051572  0.00051572]
 [-0.00061121  0.00061121]
 [-0.00057349  0.00057349]
 [-0.00053871  0.00053871]
 [-0.00057972  0.00057972]
 [-0.00058478  0.00058478]
 [-0.00052787  0.00052787]
 [-0.00054838  0.00054838]
 [-0.00063539  0.00063539]
 [-0.00047475  0.00047475]
 [-0.00058088  0.00058088]
 [-0.00058345  0.00058345]
 [-0.00059441  0.00059441]
 [-0.00062361  0.00062361]
 [-0.00062156  0.00062156]
 [-0.00053392  0.00053392]
 [-0.00046853  0.00046853]
 [-0.00060877  0.00060877]
 [-0.00059919  0.00059919]
 [-0.00055919  0.00055919]
 [-0.00058729  0.00058729]
 [-0.00056858  0.00056858]
 [-0.00062973  0.00062973]
 [-0.00062744  0.00062744]
 [-0.00056159  0.00056159]
 [-0.00060987  0.00060987]
 [-0.00056888  0.00056888]
 [-0.00061371  0.00061371]
 [-0.00065617  0.00065617]
 [-0.00059095  0.00059095]
 [-0.00063969  0.00063969]
 [-0.00058679  0.00058679]
 [-0.0005514   0.0005514 ]
 [-0.00056069  0.00056069]
 [-0.00057186  0.00057186]
 [-0.00057     0.00057   ]
 [-0.0005795   0.0005795 ]
 [-0.00055937  0.00055937]
 [-0.00059919  0.00059919]
 [-0.00059374  0.00059374]
 [-0.00059455  0.00059455]
 [-0.00054535  0.00054535]
 [-0.0005464   0.0005464 ]
 [-0.00056052  0.00056052]
 [-0.00064593  0.00064593]
 [-0.00056561  0.00056561]
 [-0.00056845  0.00056845]
 [-0.00059346  0.00059346]
 [-0.00058177  0.00058177]
 [-0.00055389  0.00055389]
 [-0.00058836  0.00058836]
 [-0.00058936  0.00058936]
 [-0.00058033  0.00058033]
 [-0.00058211  0.00058211]
 [-0.00056163  0.00056163]
 [-0.00059113  0.00059113]
 [-0.00056231  0.00056231]
 [-0.00063465  0.00063465]
 [-0.00063796  0.00063796]
 [-0.00060194  0.00060194]
 [-0.00056481  0.00056481]
 [-0.00058936  0.00058936]
 [-0.00057236  0.00057236]
 [-0.00059107  0.00059107]
 [-0.00059563  0.00059563]
 [-0.00054074  0.00054074]
 [-0.00059605  0.00059605]
 [-0.0005945   0.0005945 ]
 [-0.00061358  0.00061358]
 [-0.0005724   0.0005724 ]
 [-0.00061146  0.00061146]
 [-0.00053212  0.00053212]
 [-0.00056245  0.00056245]
 [-0.00057243  0.00057243]
 [-0.00058303  0.00058303]
 [-0.00063888  0.00063888]
 [-0.00063501  0.00063501]
 [-0.00053001  0.00053001]
 [-0.0006073   0.0006073 ]
 [-0.00060685  0.00060685]
 [-0.00059737  0.00059737]
 [-0.00061262  0.00061262]
 [-0.00066979  0.00066979]
 [-0.00057566  0.00057566]
 [-0.00058313  0.00058313]
 [-0.0006174   0.0006174 ]
 [-0.00057599  0.00057599]
 [-0.00055945  0.00055945]
 [-0.00062162  0.00062162]
 [-0.00058701  0.00058701]
 [-0.00054015  0.00054015]
 [-0.00058897  0.00058897]
 [-0.0005814   0.0005814 ]
 [-0.00043669  0.00043669]
 [-0.00058366  0.00058366]
 [-0.00059158  0.00059158]
 [-0.0006346   0.0006346 ]
 [-0.00059444  0.00059444]
 [-0.00054689  0.00054689]
 [-0.00056462  0.00056462]
 [-0.00056359  0.00056359]
 [-0.00056181  0.00056181]
 [-0.00063499  0.00063499]
 [-0.00057643  0.00057643]
 [-0.00057557  0.00057557]
 [-0.00056238  0.00056238]
 [-0.00059392  0.00059392]
 [-0.00054728  0.00054728]
 [-0.00053656  0.00053656]
 [-0.00060857  0.00060857]
 [-0.000661    0.000661  ]
 [-0.00060682  0.00060682]
 [-0.00060457  0.00060457]
 [-0.00049294  0.00049294]
 [-0.00059043  0.00059043]
 [-0.00062391  0.00062391]
 [-0.00058187  0.00058187]
 [-0.00054279  0.00054279]
 [-0.00055057  0.00055057]
 [-0.00052067  0.00052067]
 [-0.00057382  0.00057382]
 [-0.00057091  0.00057091]
 [-0.00055058  0.00055058]
 [-0.00058363  0.00058363]
 [-0.00060245  0.00060245]
 [-0.00056072  0.00056072]
 [-0.00057586  0.00057586]
 [-0.00058737  0.00058737]
 [-0.00058488  0.00058488]
 [-0.00068894  0.00068894]
 [-0.00057694  0.00057694]
 [-0.00060245  0.00060245]
 [-0.00054163  0.00054163]
 [-0.00055994  0.00055994]
 [-0.00056693  0.00056693]
 [-0.00060319  0.00060319]
 [-0.00050845  0.00050845]
 [-0.00061168  0.00061168]
 [-0.00059018  0.00059018]
 [-0.00056715  0.00056715]
 [-0.00061106  0.00061106]
 [-0.00061545  0.00061545]
 [-0.00058081  0.00058081]]
positive mean=0.0006083699408918619, std=4.44724500994198e-05
negative mean=0.0008277454180642962, std=5.7641642342787236e-05
predicted_label: [1 0 0 1 0]
y: [0 1 1 1 1]
batch_size=1024,class_num=2,acc=0.029297,time_used=0.098115
returning from NormbasedScoring
norm_leak_acc: 0.029296875
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|0|3|NormbasedScoring|None|0.9990543735224586|0.029296875|0.003272063466550337
============ apply_trainable_layer= 1 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/1/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.03 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|1|3|No_Attack|None|0.9985815602836879|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[-0.00016137  0.00016308]
 [-0.00015276  0.00015438]
 [-0.00014836  0.00014994]
 ...
 [-0.00015241  0.00015402]
 [-0.00014582  0.00014736]
 [-0.00015232  0.00015393]]
negative gradients:[[ 0.000212   -0.00021425]
 [ 0.00021516 -0.00021744]
 [ 0.00021147 -0.00021371]
 [ 0.00021024 -0.00021247]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020022 -0.00020234]
 [ 0.00021464 -0.00021691]
 [ 0.00020866 -0.00021087]
 [ 0.00020303 -0.00020519]
 [ 0.00020778 -0.00020998]
 [ 0.00020057 -0.0002027 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020708 -0.00020927]
 [ 0.00021305 -0.00021531]
 [ 0.0002004  -0.00020252]
 [ 0.00020497 -0.00020714]
 [ 0.00020163 -0.00020376]
 [ 0.00021288 -0.00021513]
 [ 0.00020813 -0.00021034]
 [ 0.00019882 -0.00020092]
 [ 0.00020462 -0.00020678]
 [ 0.00019565 -0.00019772]
 [ 0.00020585 -0.00020803]
 [ 0.00020409 -0.00020625]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00021253 -0.00021478]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.000212   -0.00021425]
 [ 0.00020128 -0.00020341]
 [ 0.00020848 -0.00021069]
 [ 0.0002069  -0.00020909]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020884 -0.00021105]
 [ 0.00020567 -0.00020785]
 [ 0.00020989 -0.00021211]
 [ 0.00020901 -0.00021123]
 [ 0.00020954 -0.00021176]
 [ 0.00021147 -0.00021371]
 [ 0.00021534 -0.00021762]
 [ 0.00020708 -0.00020927]
 [ 0.0002113  -0.00021354]
 [ 0.00021182 -0.00021407]
 [ 0.00021305 -0.00021531]
 [ 0.00021692 -0.00021922]
 [ 0.00020585 -0.00020803]
 [ 0.00020426 -0.00020643]
 [ 0.00020356 -0.00020572]
 [ 0.00020303 -0.00020519]
 [ 0.00021305 -0.00021531]
 [ 0.00019864 -0.00020074]
 [ 0.00020673 -0.00020892]
 [ 0.00021639 -0.00021869]
 [ 0.00021552 -0.0002178 ]
 [ 0.00020673 -0.00020892]
 [ 0.00020637 -0.00020856]
 [ 0.00019565 -0.00019772]
 [ 0.00020321 -0.00020536]
 [ 0.00020743 -0.00020963]
 [ 0.00020919 -0.0002114 ]
 [ 0.00020409 -0.00020625]
 [ 0.00019548 -0.00019755]
 [ 0.00020216 -0.0002043 ]
 [ 0.00021253 -0.00021478]
 [ 0.00020884 -0.00021105]
 [ 0.000212   -0.00021425]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020708 -0.00020927]
 [ 0.00020128 -0.00020341]
 [ 0.0002062  -0.00020838]
 [ 0.00021376 -0.00021602]
 [ 0.00021358 -0.00021584]
 [ 0.00020848 -0.00021069]
 [ 0.00019829 -0.00020039]
 [ 0.00021182 -0.00021407]
 [ 0.00020743 -0.00020963]
 [ 0.00020409 -0.00020625]
 [ 0.00019723 -0.00019932]
 [ 0.00021446 -0.00021673]
 [ 0.00020778 -0.00020998]
 [ 0.00020514 -0.00020732]
 [ 0.00020655 -0.00020874]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020971 -0.00021194]
 [ 0.00021341 -0.00021567]
 [ 0.00021639 -0.00021869]
 [ 0.00019618 -0.00019826]
 [ 0.00021094 -0.00021318]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020708 -0.00020927]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021059 -0.00021282]
 [ 0.00019864 -0.00020074]
 [ 0.00020391 -0.00020607]
 [ 0.00021481 -0.00021709]
 [ 0.00019829 -0.00020039]
 [ 0.00020321 -0.00020536]
 [ 0.00020426 -0.00020643]
 [ 0.00020514 -0.00020732]
 [ 0.00021112 -0.00021336]
 [ 0.00020321 -0.00020536]
 [ 0.00021692 -0.00021922]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020936 -0.00021158]
 [ 0.00020532 -0.00020749]
 [ 0.00021534 -0.00021762]
 [ 0.00019917 -0.00020128]
 [ 0.00020585 -0.00020803]
 [ 0.00020514 -0.00020732]
 [ 0.0002055  -0.00020767]
 [ 0.00020725 -0.00020945]
 [ 0.00020479 -0.00020696]
 [ 0.00021147 -0.00021371]
 [ 0.00019794 -0.00020003]
 [ 0.00020145 -0.00020359]
 [ 0.00021534 -0.00021762]
 [ 0.00021411 -0.00021638]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00020936 -0.00021158]
 [ 0.00021376 -0.00021602]
 [ 0.0002113  -0.00021354]
 [ 0.00019811 -0.00020021]
 [ 0.00020286 -0.00020501]
 [ 0.00020532 -0.00020749]
 [ 0.00021218 -0.00021442]
 [ 0.00020884 -0.00021105]
 [ 0.00020936 -0.00021158]
 [ 0.00020954 -0.00021176]
 [ 0.00020514 -0.00020732]
 [ 0.00021288 -0.00021513]
 [ 0.00020831 -0.00021051]
 [ 0.00021182 -0.00021407]
 [ 0.00020303 -0.00020519]
 [ 0.00020585 -0.00020803]
 [ 0.00020796 -0.00021016]
 [ 0.00020954 -0.00021176]
 [ 0.00019934 -0.00020145]
 [ 0.00020022 -0.00020234]
 [ 0.00020233 -0.00020447]
 [ 0.00019864 -0.00020074]
 [ 0.00020813 -0.00021034]
 [ 0.00020954 -0.00021176]
 [ 0.00021481 -0.00021709]
 [ 0.00021165 -0.00021389]
 [ 0.00021464 -0.00021691]
 [ 0.00021112 -0.00021336]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021007 -0.00021229]
 [ 0.00020462 -0.00020678]
 [ 0.000212   -0.00021425]
 [ 0.00020567 -0.00020785]
 [ 0.00021042 -0.00021265]
 [ 0.00019934 -0.00020145]
 [ 0.00021446 -0.00021673]
 [ 0.00020514 -0.00020732]
 [ 0.00021815 -0.00022046]
 [ 0.00020339 -0.00020554]
 [ 0.00021059 -0.00021282]
 [ 0.00020497 -0.00020714]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021323 -0.00021549]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020866 -0.00021087]
 [ 0.0002069  -0.00020909]
 [ 0.00019952 -0.00020163]
 [ 0.000196   -0.00019808]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020303 -0.00020519]
 [ 0.00020655 -0.00020874]
 [ 0.00021657 -0.00021886]
 [ 0.0002004  -0.00020252]
 [ 0.00019987 -0.00020199]
 [ 0.00019723 -0.00019932]
 [ 0.00020286 -0.00020501]
 [ 0.00020989 -0.00021211]
 [ 0.00019671 -0.00019879]
 [ 0.00021692 -0.00021922]
 [ 0.0002127  -0.00021496]
 [ 0.00020233 -0.00020447]
 [ 0.00021464 -0.00021691]
 [ 0.00021481 -0.00021709]
 [ 0.00021094 -0.00021318]
 [ 0.00020989 -0.00021211]
 [ 0.00019776 -0.00019986]
 [ 0.00020848 -0.00021069]
 [ 0.00020321 -0.00020536]
 [ 0.00019882 -0.00020092]
 [ 0.00020936 -0.00021158]
 [ 0.0002062  -0.00020838]
 [ 0.00021147 -0.00021371]
 [ 0.0002018  -0.00020394]
 [ 0.00020426 -0.00020643]
 [ 0.00020286 -0.00020501]
 [ 0.00020901 -0.00021123]
 [ 0.00020321 -0.00020536]
 [ 0.00021481 -0.00021709]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020374 -0.0002059 ]
 [ 0.00019706 -0.00019915]
 [ 0.00020022 -0.00020234]
 [ 0.00020022 -0.00020234]
 [ 0.00019618 -0.00019826]
 [ 0.0002011  -0.00020323]
 [ 0.00020514 -0.00020732]
 [ 0.00020567 -0.00020785]
 [ 0.0002171  -0.0002194 ]
 [ 0.00021745 -0.00021975]
 [ 0.00020198 -0.00020412]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020497 -0.00020714]
 [ 0.00019706 -0.00019915]
 [ 0.00021094 -0.00021318]
 [ 0.00020251 -0.00020465]
 [ 0.00021253 -0.00021478]
 [ 0.00020725 -0.00020945]
 [ 0.00020444 -0.00020661]
 [ 0.00021007 -0.00021229]
 [ 0.00020848 -0.00021069]
 [ 0.00020708 -0.00020927]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.00021094 -0.00021318]
 [ 0.00021042 -0.00021265]
 [ 0.00021094 -0.00021318]
 [ 0.00020409 -0.00020625]
 [ 0.00021639 -0.00021869]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021692 -0.00021922]
 [ 0.00019688 -0.00019897]
 [ 0.00021885 -0.00022117]
 [ 0.00020426 -0.00020643]
 [ 0.00021077 -0.000213  ]
 [ 0.00020479 -0.00020696]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021042 -0.00021265]
 [ 0.0002055  -0.00020767]
 [ 0.00021024 -0.00021247]
 [ 0.00020145 -0.00020359]
 [ 0.00020198 -0.00020412]
 [ 0.00020092 -0.00020305]
 [ 0.00020725 -0.00020945]
 [ 0.00020831 -0.00021051]
 [ 0.00019741 -0.0001995 ]
 [ 0.00020971 -0.00021194]
 [ 0.00020409 -0.00020625]
 [ 0.000212   -0.00021425]
 [ 0.0002113  -0.00021354]
 [ 0.00019671 -0.00019879]
 [ 0.00020743 -0.00020963]
 [ 0.00021288 -0.00021513]
 [ 0.00020743 -0.00020963]
 [ 0.00021147 -0.00021371]
 [ 0.00021182 -0.00021407]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020901 -0.00021123]
 [ 0.00021147 -0.00021371]
 [ 0.00019161 -0.00019364]
 [ 0.00020145 -0.00020359]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00021762 -0.00021993]
 [ 0.00021481 -0.00021709]
 [ 0.00019846 -0.00020057]
 [ 0.00019882 -0.00020092]
 [ 0.00020567 -0.00020785]
 [ 0.00021007 -0.00021229]
 [ 0.0002011  -0.00020323]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020233 -0.00020447]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020444 -0.00020661]
 [ 0.00020128 -0.00020341]
 [ 0.00020426 -0.00020643]
 [ 0.0002062  -0.00020838]
 [ 0.00020057 -0.0002027 ]
 [ 0.00019776 -0.00019986]
 [ 0.00021499 -0.00021727]
 [ 0.00019794 -0.00020003]
 [ 0.00020356 -0.00020572]
 [ 0.00021376 -0.00021602]
 [ 0.0002127  -0.00021496]
 [ 0.00020725 -0.00020945]
 [ 0.0002069  -0.00020909]
 [ 0.00020743 -0.00020963]
 [ 0.00021165 -0.00021389]
 [ 0.0002127  -0.00021496]
 [ 0.0002018  -0.00020394]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00020128 -0.00020341]
 [ 0.00021745 -0.00021975]
 [ 0.00020778 -0.00020998]
 [ 0.00021007 -0.00021229]
 [ 0.00019899 -0.0002011 ]
 [ 0.00021464 -0.00021691]
 [ 0.00021499 -0.00021727]
 [ 0.00020901 -0.00021123]
 [ 0.00020848 -0.00021069]
 [ 0.00020954 -0.00021176]
 [ 0.00021411 -0.00021638]
 [ 0.00020831 -0.00021051]
 [ 0.00020796 -0.00021016]
 [ 0.00021094 -0.00021318]
 [ 0.00020128 -0.00020341]
 [ 0.00020497 -0.00020714]
 [ 0.00021446 -0.00021673]
 [ 0.00021622 -0.00021851]
 [ 0.00021253 -0.00021478]
 [ 0.00019811 -0.00020021]
 [ 0.00021112 -0.00021336]
 [ 0.00021253 -0.00021478]
 [ 0.00020708 -0.00020927]
 [ 0.00021077 -0.000213  ]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00021218 -0.00021442]
 [ 0.0002113  -0.00021354]
 [ 0.00020356 -0.00020572]
 [ 0.00021305 -0.00021531]
 [ 0.00021464 -0.00021691]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020585 -0.00020803]
 [ 0.00020391 -0.00020607]
 [ 0.00021446 -0.00021673]
 [ 0.00020866 -0.00021087]
 [ 0.00020725 -0.00020945]
 [ 0.00020286 -0.00020501]
 [ 0.00020778 -0.00020998]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021024 -0.00021247]
 [ 0.00020602 -0.00020821]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020831 -0.00021051]
 [ 0.0002113  -0.00021354]
 [ 0.00020637 -0.00020856]
 [ 0.00020145 -0.00020359]
 [ 0.00020514 -0.00020732]
 [ 0.00019776 -0.00019986]
 [ 0.00020637 -0.00020856]
 [ 0.00020251 -0.00020465]
 [ 0.00021112 -0.00021336]
 [ 0.00020216 -0.0002043 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020884 -0.00021105]
 [ 0.00021024 -0.00021247]
 [ 0.00021147 -0.00021371]
 [ 0.00020321 -0.00020536]
 [ 0.00020901 -0.00021123]
 [ 0.00020743 -0.00020963]
 [ 0.000196   -0.00019808]
 [ 0.00020198 -0.00020412]
 [ 0.0002069  -0.00020909]
 [ 0.00020567 -0.00020785]
 [ 0.0002069  -0.00020909]
 [ 0.00020796 -0.00021016]
 [ 0.00020778 -0.00020998]
 [ 0.00020145 -0.00020359]
 [ 0.00020655 -0.00020874]
 [ 0.00021604 -0.00021833]
 [ 0.00020198 -0.00020412]
 [ 0.00020901 -0.00021123]
 [ 0.00021569 -0.00021798]
 [ 0.00020936 -0.00021158]
 [ 0.00021024 -0.00021247]
 [ 0.00020409 -0.00020625]
 [ 0.00020848 -0.00021069]
 [ 0.00020444 -0.00020661]
 [ 0.00021112 -0.00021336]
 [ 0.00020655 -0.00020874]
 [ 0.00020637 -0.00020856]
 [ 0.00021165 -0.00021389]
 [ 0.00020848 -0.00021069]
 [ 0.00020989 -0.00021211]
 [ 0.00020708 -0.00020927]
 [ 0.00020884 -0.00021105]
 [ 0.00021534 -0.00021762]
 [ 0.0002011  -0.00020323]
 [ 0.00020409 -0.00020625]
 [ 0.0002018  -0.00020394]
 [ 0.00020391 -0.00020607]
 [ 0.00020444 -0.00020661]
 [ 0.00021604 -0.00021833]
 [ 0.00021112 -0.00021336]
 [ 0.00019846 -0.00020057]
 [ 0.00021288 -0.00021513]
 [ 0.00021042 -0.00021265]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020356 -0.00020572]
 [ 0.00020866 -0.00021087]
 [ 0.0002011  -0.00020323]
 [ 0.00020954 -0.00021176]
 [ 0.00020796 -0.00021016]
 [ 0.00021622 -0.00021851]
 [ 0.00020602 -0.00020821]
 [ 0.0002113  -0.00021354]
 [ 0.00021499 -0.00021727]
 [ 0.00020848 -0.00021069]
 [ 0.00021868 -0.000221  ]
 [ 0.00020831 -0.00021051]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020813 -0.00021034]
 [ 0.00021042 -0.00021265]
 [ 0.00020708 -0.00020927]
 [ 0.0002004  -0.00020252]
 [ 0.00020884 -0.00021105]
 [ 0.00020725 -0.00020945]
 [ 0.00020321 -0.00020536]
 [ 0.00019214 -0.00019417]
 [ 0.0002018  -0.00020394]
 [ 0.00020444 -0.00020661]
 [ 0.00020919 -0.0002114 ]
 [ 0.00021042 -0.00021265]
 [ 0.00021323 -0.00021549]
 [ 0.00019618 -0.00019826]
 [ 0.00020409 -0.00020625]
 [ 0.00020321 -0.00020536]
 [ 0.00020919 -0.0002114 ]
 [ 0.0002011  -0.00020323]
 [ 0.00021358 -0.00021584]
 [ 0.00020831 -0.00021051]
 [ 0.00021569 -0.00021798]
 [ 0.00020813 -0.00021034]
 [ 0.00020971 -0.00021194]
 [ 0.00020567 -0.00020785]
 [ 0.00020725 -0.00020945]
 [ 0.00020233 -0.00020447]
 [ 0.0002055  -0.00020767]
 [ 0.00020286 -0.00020501]
 [ 0.00019846 -0.00020057]
 [ 0.00020479 -0.00020696]
 [ 0.00020339 -0.00020554]
 [ 0.00020901 -0.00021123]
 [ 0.00020919 -0.0002114 ]
 [ 0.00019987 -0.00020199]
 [ 0.00020936 -0.00021158]
 [ 0.00021464 -0.00021691]
 [ 0.00020286 -0.00020501]
 [ 0.00020514 -0.00020732]
 [ 0.00020971 -0.00021194]
 [ 0.00020251 -0.00020465]
 [ 0.00020831 -0.00021051]
 [ 0.00020532 -0.00020749]
 [ 0.00021411 -0.00021638]
 [ 0.00021077 -0.000213  ]
 [ 0.00021604 -0.00021833]
 [ 0.00020321 -0.00020536]
 [ 0.00021411 -0.00021638]
 [ 0.00021182 -0.00021407]
 [ 0.00020954 -0.00021176]
 [ 0.00020971 -0.00021194]
 [ 0.00020514 -0.00020732]
 [ 0.00020585 -0.00020803]
 [ 0.00020005 -0.00020217]
 [ 0.00019987 -0.00020199]
 [ 0.00020022 -0.00020234]]
positive mean=0.00021355401258915663, std=7.162120709836017e-06
negative mean=0.0002946807653643191, std=7.565464784420328e-06
predicted_label: [1 0 0 0 1]
y: [0 1 1 1 0]
batch_size=1024,class_num=2,acc=0.000000,time_used=0.430128
returning from NormbasedScoring
norm_leak_acc: 0.0
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|1|3|NormbasedScoring|None|0.9985815602836879|0.0|0.0
================= iter seed  100  =================
===== No Defense ======
running on cuda0
============ apply_trainable_layer= 0 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/0/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.01 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.01 train_acc:1.00 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|0|3|No_Attack|None|0.9990543735224586|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[ 0.00047452 -0.00047452]
 [ 0.00048416 -0.00048416]
 [ 0.00048831 -0.00048831]
 ...
 [ 0.00041619 -0.00041619]
 [ 0.00045294 -0.00045294]
 [ 0.00048071 -0.00048071]]
negative gradients:[[-0.00040014  0.00040014]
 [-0.00048305  0.00048305]
 [-0.00048435  0.00048435]
 [-0.00036471  0.00036471]
 [-0.00056636  0.00056636]
 [-0.00041843  0.00041843]
 [-0.000471    0.000471  ]
 [-0.00046116  0.00046116]
 [-0.00046897  0.00046897]
 [-0.00046201  0.00046201]
 [-0.00049724  0.00049724]
 [-0.00048401  0.00048401]
 [-0.00044043  0.00044043]
 [-0.00041161  0.00041161]
 [-0.00060974  0.00060974]
 [-0.00050667  0.00050667]
 [-0.0004639   0.0004639 ]
 [-0.00041102  0.00041102]
 [-0.00040374  0.00040374]
 [-0.00049183  0.00049183]
 [-0.00048138  0.00048138]
 [-0.00044153  0.00044153]
 [-0.00035796  0.00035796]
 [-0.00035637  0.00035637]
 [-0.00061667  0.00061667]
 [-0.00050534  0.00050534]
 [-0.00042735  0.00042735]
 [-0.00053507  0.00053507]
 [-0.00046908  0.00046908]
 [-0.00037961  0.00037961]
 [-0.0004781   0.0004781 ]
 [-0.00053907  0.00053907]
 [-0.00048463  0.00048463]
 [-0.00041549  0.00041549]
 [-0.00058704  0.00058704]
 [-0.00048135  0.00048135]
 [-0.00048725  0.00048725]
 [-0.00043301  0.00043301]
 [-0.00044689  0.00044689]
 [-0.00050411  0.00050411]
 [-0.00032466  0.00032466]
 [-0.00040525  0.00040525]
 [-0.00049751  0.00049751]
 [-0.0004348   0.0004348 ]
 [-0.00042768  0.00042768]
 [-0.00040964  0.00040964]
 [-0.00050672  0.00050672]
 [-0.00036774  0.00036774]
 [-0.00043768  0.00043768]
 [-0.00049013  0.00049013]
 [-0.00052484  0.00052484]
 [-0.00053039  0.00053039]
 [-0.00041602  0.00041602]
 [-0.00060867  0.00060867]
 [-0.0003699   0.0003699 ]
 [-0.00041786  0.00041786]
 [-0.00049448  0.00049448]
 [-0.00043923  0.00043923]
 [-0.00046957  0.00046957]
 [-0.00036248  0.00036248]
 [-0.00040096  0.00040096]
 [-0.00047016  0.00047016]
 [-0.00060569  0.00060569]
 [-0.00041811  0.00041811]
 [-0.00051924  0.00051924]
 [-0.00053745  0.00053745]
 [-0.00037349  0.00037349]
 [-0.00040837  0.00040837]
 [-0.00049053  0.00049053]
 [-0.00056822  0.00056822]
 [-0.00046975  0.00046975]
 [-0.00048552  0.00048552]
 [-0.00044056  0.00044056]
 [-0.0004097   0.0004097 ]
 [-0.00048511  0.00048511]
 [-0.00037731  0.00037731]
 [-0.00050916  0.00050916]
 [-0.00049511  0.00049511]
 [-0.00044803  0.00044803]
 [-0.0005165   0.0005165 ]
 [-0.00061964  0.00061964]
 [-0.00053709  0.00053709]
 [-0.00041737  0.00041737]
 [-0.00053869  0.00053869]
 [-0.00054606  0.00054606]
 [-0.0004675   0.0004675 ]
 [-0.00041499  0.00041499]
 [-0.00044237  0.00044237]
 [-0.00035441  0.00035441]
 [-0.00043731  0.00043731]
 [-0.00042574  0.00042574]
 [-0.00046847  0.00046847]
 [-0.00037389  0.00037389]
 [-0.0003802   0.0003802 ]
 [-0.00046153  0.00046153]
 [-0.00037139  0.00037139]
 [-0.00053824  0.00053824]
 [-0.00045506  0.00045506]
 [-0.00035271  0.00035271]
 [-0.00043943  0.00043943]
 [-0.00033398  0.00033398]
 [-0.00037033  0.00037033]
 [-0.0004127   0.0004127 ]
 [-0.00040347  0.00040347]
 [-0.00041268  0.00041268]
 [-0.00050976  0.00050976]
 [-0.00048259  0.00048259]
 [-0.00050037  0.00050037]
 [-0.00052467  0.00052467]
 [-0.00034914  0.00034914]
 [-0.00055632  0.00055632]
 [-0.00046323  0.00046323]
 [-0.00044193  0.00044193]
 [-0.00052749  0.00052749]
 [-0.00049608  0.00049608]
 [-0.00049913  0.00049913]
 [-0.00057233  0.00057233]
 [-0.00041701  0.00041701]
 [-0.00033485  0.00033485]
 [-0.00038902  0.00038902]
 [-0.00045589  0.00045589]
 [-0.00043659  0.00043659]
 [-0.00046716  0.00046716]
 [-0.00034383  0.00034383]
 [-0.00042974  0.00042974]
 [-0.00048767  0.00048767]
 [-0.00043467  0.00043467]
 [-0.00047072  0.00047072]
 [-0.000528    0.000528  ]
 [-0.0004326   0.0004326 ]
 [-0.00040257  0.00040257]
 [-0.00038523  0.00038523]
 [-0.00050195  0.00050195]
 [-0.00053884  0.00053884]
 [-0.00049928  0.00049928]
 [-0.00058507  0.00058507]
 [-0.00046605  0.00046605]
 [-0.0004664   0.0004664 ]
 [-0.00037871  0.00037871]
 [-0.00039282  0.00039282]
 [-0.00049209  0.00049209]
 [-0.00039574  0.00039574]
 [-0.000516    0.000516  ]
 [-0.00056436  0.00056436]
 [-0.00054341  0.00054341]
 [-0.00047397  0.00047397]
 [-0.00046635  0.00046635]
 [-0.00047275  0.00047275]
 [-0.00051487  0.00051487]
 [-0.00054937  0.00054937]
 [-0.0004559   0.0004559 ]
 [-0.00045889  0.00045889]
 [-0.00039115  0.00039115]
 [-0.00052979  0.00052979]
 [-0.00042992  0.00042992]
 [-0.0003935   0.0003935 ]
 [-0.0003571   0.0003571 ]
 [-0.00042377  0.00042377]
 [-0.00044959  0.00044959]
 [-0.00046448  0.00046448]
 [-0.00048303  0.00048303]
 [-0.00052785  0.00052785]
 [-0.00056483  0.00056483]
 [-0.00041044  0.00041044]
 [-0.00041158  0.00041158]
 [-0.00047299  0.00047299]
 [-0.00041135  0.00041135]
 [-0.00056066  0.00056066]
 [-0.0004563   0.0004563 ]
 [-0.00045014  0.00045014]
 [-0.00048017  0.00048017]
 [-0.0005049   0.0005049 ]
 [-0.00050357  0.00050357]
 [-0.00056817  0.00056817]
 [-0.00047691  0.00047691]
 [-0.00039557  0.00039557]
 [-0.00053275  0.00053275]
 [-0.00051666  0.00051666]
 [-0.00049114  0.00049114]
 [-0.00044646  0.00044646]
 [-0.00053656  0.00053656]
 [-0.00037537  0.00037537]
 [-0.00038083  0.00038083]
 [-0.000436    0.000436  ]
 [-0.00042876  0.00042876]
 [-0.00046855  0.00046855]
 [-0.00043633  0.00043633]
 [-0.00045827  0.00045827]
 [-0.00051435  0.00051435]
 [-0.00059524  0.00059524]
 [-0.00058053  0.00058053]
 [-0.00052585  0.00052585]
 [-0.00047435  0.00047435]
 [-0.00044555  0.00044555]
 [-0.00048631  0.00048631]
 [-0.00044576  0.00044576]
 [-0.00044413  0.00044413]
 [-0.00049864  0.00049864]
 [-0.00046306  0.00046306]
 [-0.00048362  0.00048362]
 [-0.00048319  0.00048319]
 [-0.00045741  0.00045741]
 [-0.00044256  0.00044256]
 [-0.00047797  0.00047797]
 [-0.00048068  0.00048068]
 [-0.0004173   0.0004173 ]
 [-0.00042013  0.00042013]
 [-0.00049652  0.00049652]
 [-0.00053278  0.00053278]
 [-0.00043531  0.00043531]
 [-0.00049513  0.00049513]
 [-0.0004654   0.0004654 ]
 [-0.00051527  0.00051527]
 [-0.00046347  0.00046347]
 [-0.00048101  0.00048101]
 [-0.00035863  0.00035863]
 [-0.00037127  0.00037127]
 [-0.00053454  0.00053454]
 [-0.00034255  0.00034255]
 [-0.00047959  0.00047959]
 [-0.0005797   0.0005797 ]
 [-0.00049886  0.00049886]
 [-0.00057047  0.00057047]
 [-0.00053514  0.00053514]
 [-0.00052859  0.00052859]
 [-0.00037371  0.00037371]
 [-0.0005171   0.0005171 ]
 [-0.0005682   0.0005682 ]
 [-0.00045025  0.00045025]
 [-0.00037355  0.00037355]
 [-0.00046547  0.00046547]
 [-0.00041555  0.00041555]
 [-0.00036179  0.00036179]
 [-0.0005209   0.0005209 ]
 [-0.00035831  0.00035831]
 [-0.00042703  0.00042703]
 [-0.00038336  0.00038336]
 [-0.00055519  0.00055519]
 [-0.00045865  0.00045865]
 [-0.00048932  0.00048932]
 [-0.0004127   0.0004127 ]
 [-0.00035887  0.00035887]
 [-0.00047961  0.00047961]
 [-0.00035892  0.00035892]
 [-0.00040096  0.00040096]
 [-0.00043404  0.00043404]
 [-0.00050025  0.00050025]
 [-0.0004721   0.0004721 ]
 [-0.00034619  0.00034619]
 [-0.00040417  0.00040417]
 [-0.00037437  0.00037437]
 [-0.00048759  0.00048759]
 [-0.00050206  0.00050206]
 [-0.00040139  0.00040139]
 [-0.00047896  0.00047896]
 [-0.00049601  0.00049601]
 [-0.00042431  0.00042431]
 [-0.00034813  0.00034813]
 [-0.00046975  0.00046975]
 [-0.00035994  0.00035994]
 [-0.00036616  0.00036616]
 [-0.00032485  0.00032485]
 [-0.00034216  0.00034216]
 [-0.00058053  0.00058053]
 [-0.0004749   0.0004749 ]
 [-0.00050527  0.00050527]
 [-0.00046407  0.00046407]
 [-0.00036487  0.00036487]
 [-0.00054788  0.00054788]
 [-0.00052513  0.00052513]
 [-0.00050393  0.00050393]
 [-0.00046619  0.00046619]
 [-0.00043235  0.00043235]
 [-0.00045391  0.00045391]
 [-0.00051151  0.00051151]
 [-0.00045964  0.00045964]
 [-0.00041763  0.00041763]
 [-0.00056351  0.00056351]
 [-0.00048588  0.00048588]
 [-0.00042503  0.00042503]
 [-0.0005043   0.0005043 ]
 [-0.00042401  0.00042401]
 [-0.000593    0.000593  ]
 [-0.00041896  0.00041896]
 [-0.00053389  0.00053389]
 [-0.00046213  0.00046213]
 [-0.00053936  0.00053936]
 [-0.0004583   0.0004583 ]
 [-0.00055816  0.00055816]
 [-0.00034425  0.00034425]
 [-0.00034943  0.00034943]
 [-0.00045265  0.00045265]
 [-0.000463    0.000463  ]
 [-0.00040446  0.00040446]
 [-0.00036476  0.00036476]
 [-0.00031511  0.00031511]
 [-0.00047229  0.00047229]
 [-0.00042102  0.00042102]
 [-0.00036251  0.00036251]
 [-0.00040165  0.00040165]
 [-0.00049513  0.00049513]
 [-0.0004062   0.0004062 ]
 [-0.0005167   0.0005167 ]
 [-0.00037441  0.00037441]
 [-0.00047461  0.00047461]
 [-0.00031671  0.00031671]
 [-0.0004001   0.0004001 ]
 [-0.00054147  0.00054147]
 [-0.00048635  0.00048635]
 [-0.00033726  0.00033726]
 [-0.00047218  0.00047218]
 [-0.00049142  0.00049142]
 [-0.00040962  0.00040962]
 [-0.00040794  0.00040794]
 [-0.00056294  0.00056294]
 [-0.0004244   0.0004244 ]
 [-0.00049837  0.00049837]
 [-0.00037453  0.00037453]
 [-0.00057888  0.00057888]
 [-0.00044421  0.00044421]
 [-0.00051461  0.00051461]
 [-0.00049142  0.00049142]
 [-0.00059538  0.00059538]
 [-0.0004659   0.0004659 ]
 [-0.00049086  0.00049086]
 [-0.00039406  0.00039406]
 [-0.00043272  0.00043272]
 [-0.00031634  0.00031634]
 [-0.00040993  0.00040993]
 [-0.00036536  0.00036536]
 [-0.0004335   0.0004335 ]
 [-0.00037215  0.00037215]
 [-0.00038634  0.00038634]
 [-0.00046567  0.00046567]
 [-0.00051912  0.00051912]
 [-0.00048139  0.00048139]
 [-0.00044081  0.00044081]
 [-0.00044321  0.00044321]
 [-0.0004867   0.0004867 ]
 [-0.00042043  0.00042043]
 [-0.0003695   0.0003695 ]
 [-0.00039456  0.00039456]
 [-0.00055756  0.00055756]
 [-0.00045778  0.00045778]
 [-0.00045587  0.00045587]
 [-0.00043421  0.00043421]
 [-0.00041744  0.00041744]
 [-0.00044522  0.00044522]
 [-0.00044799  0.00044799]
 [-0.00039911  0.00039911]
 [-0.00039132  0.00039132]
 [-0.00045952  0.00045952]
 [-0.00053177  0.00053177]
 [-0.00053228  0.00053228]
 [-0.00057767  0.00057767]
 [-0.00040334  0.00040334]
 [-0.00049695  0.00049695]
 [-0.00040869  0.00040869]
 [-0.00040271  0.00040271]
 [-0.00049288  0.00049288]
 [-0.00040906  0.00040906]
 [-0.0004509   0.0004509 ]
 [-0.00038068  0.00038068]
 [-0.00046198  0.00046198]
 [-0.00054713  0.00054713]
 [-0.00053772  0.00053771]
 [-0.0004124   0.0004124 ]
 [-0.00039115  0.00039115]
 [-0.00045287  0.00045287]
 [-0.00048773  0.00048773]
 [-0.00051974  0.00051974]
 [-0.00056573  0.00056573]
 [-0.00043364  0.00043364]
 [-0.00053651  0.00053651]
 [-0.00040383  0.00040383]
 [-0.00054735  0.00054735]
 [-0.0005753   0.0005753 ]
 [-0.00054037  0.00054037]
 [-0.00037649  0.00037649]
 [-0.00044138  0.00044138]
 [-0.0003684   0.0003684 ]
 [-0.00045634  0.00045634]
 [-0.00059093  0.00059093]
 [-0.00032164  0.00032164]
 [-0.00037911  0.00037911]
 [-0.00052278  0.00052278]
 [-0.00055118  0.00055118]
 [-0.00051478  0.00051478]
 [-0.00053308  0.00053308]
 [-0.00053294  0.00053294]
 [-0.00046795  0.00046795]
 [-0.00045933  0.00045933]
 [-0.0004643   0.0004643 ]
 [-0.00043977  0.00043977]
 [-0.00041301  0.00041301]
 [-0.00038984  0.00038984]
 [-0.00053353  0.00053353]
 [-0.00051376  0.00051376]
 [-0.00057334  0.00057334]
 [-0.0004971   0.0004971 ]
 [-0.0006203   0.0006203 ]
 [-0.00045553  0.00045553]
 [-0.00048524  0.00048524]
 [-0.00063414  0.00063414]
 [-0.0003725   0.0003725 ]
 [-0.00030217  0.00030217]
 [-0.00047102  0.00047102]
 [-0.0005107   0.0005107 ]
 [-0.00043903  0.00043903]
 [-0.0006177   0.0006177 ]
 [-0.00043348  0.00043348]
 [-0.0005924   0.0005924 ]
 [-0.00049085  0.00049085]
 [-0.00048785  0.00048785]
 [-0.00046674  0.00046674]
 [-0.00035056  0.00035056]
 [-0.00050133  0.00050133]
 [-0.00042685  0.00042685]
 [-0.00031218  0.00031218]
 [-0.00056152  0.00056152]
 [-0.00049237  0.00049237]
 [-0.00043311  0.00043311]
 [-0.0006056   0.0006056 ]
 [-0.00046244  0.00046244]
 [-0.00056194  0.00056194]
 [-0.00048112  0.00048112]
 [-0.00048962  0.00048963]
 [-0.00032925  0.00032925]
 [-0.00039519  0.00039519]
 [-0.00038777  0.00038777]
 [-0.00057056  0.00057056]
 [-0.00042311  0.00042311]
 [-0.00040469  0.00040469]
 [-0.00054092  0.00054092]
 [-0.00047083  0.00047083]
 [-0.00044205  0.00044205]
 [-0.00048811  0.00048811]
 [-0.00041725  0.00041725]
 [-0.00041199  0.00041199]
 [-0.00041955  0.00041955]
 [-0.00044872  0.00044872]
 [-0.00055321  0.00055321]
 [-0.0006153   0.0006153 ]
 [-0.00056503  0.00056503]
 [-0.00043188  0.00043188]
 [-0.00040709  0.00040709]
 [-0.0005032   0.0005032 ]
 [-0.00050115  0.00050115]
 [-0.00056259  0.00056259]
 [-0.0004295   0.0004295 ]
 [-0.00057138  0.00057138]
 [-0.00037722  0.00037722]
 [-0.00052023  0.00052023]
 [-0.00048073  0.00048073]
 [-0.0003622   0.0003622 ]
 [-0.00048495  0.00048495]
 [-0.00032053  0.00032053]
 [-0.00041587  0.00041587]
 [-0.00040298  0.00040298]
 [-0.00039596  0.00039596]
 [-0.00046666  0.00046666]
 [-0.00054886  0.00054886]
 [-0.00048791  0.00048791]
 [-0.00043876  0.00043876]
 [-0.00043196  0.00043196]
 [-0.00042312  0.00042312]
 [-0.0004217   0.0004217 ]
 [-0.00043614  0.00043614]
 [-0.00059606  0.00059606]
 [-0.00041965  0.00041965]
 [-0.000356    0.000356  ]
 [-0.0004391   0.0004391 ]
 [-0.00042236  0.00042236]
 [-0.00043214  0.00043214]
 [-0.0004531   0.0004531 ]
 [-0.00054961  0.00054961]
 [-0.00061146  0.00061146]
 [-0.00045198  0.00045198]
 [-0.00060503  0.00060503]
 [-0.00050576  0.00050576]
 [-0.00038666  0.00038666]
 [-0.00046417  0.00046417]]
positive mean=0.0006332413177005947, std=6.47886554361321e-05
negative mean=0.0006523587508127093, std=9.584351209923625e-05
predicted_label: [0 1 1 1 0]
y: [0 0 0 1 0]
batch_size=1024,class_num=2,acc=0.430664,time_used=0.969946
returning from NormbasedScoring
norm_leak_acc: 0.4306640625
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|0|3|NormbasedScoring|None|0.9990543735224586|0.4306640625|0.4423833657423711
============ apply_trainable_layer= 1 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/1/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.03 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|1|3|No_Attack|None|0.9985815602836879|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[-0.00016137  0.00016308]
 [-0.00015276  0.00015438]
 [-0.00014836  0.00014994]
 ...
 [-0.00015241  0.00015402]
 [-0.00014582  0.00014736]
 [-0.00015232  0.00015393]]
negative gradients:[[ 0.000212   -0.00021425]
 [ 0.00021516 -0.00021744]
 [ 0.00021147 -0.00021371]
 [ 0.00021024 -0.00021247]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020022 -0.00020234]
 [ 0.00021464 -0.00021691]
 [ 0.00020866 -0.00021087]
 [ 0.00020303 -0.00020519]
 [ 0.00020778 -0.00020998]
 [ 0.00020057 -0.0002027 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020708 -0.00020927]
 [ 0.00021305 -0.00021531]
 [ 0.0002004  -0.00020252]
 [ 0.00020497 -0.00020714]
 [ 0.00020163 -0.00020376]
 [ 0.00021288 -0.00021513]
 [ 0.00020813 -0.00021034]
 [ 0.00019882 -0.00020092]
 [ 0.00020462 -0.00020678]
 [ 0.00019565 -0.00019772]
 [ 0.00020585 -0.00020803]
 [ 0.00020409 -0.00020625]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00021253 -0.00021478]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.000212   -0.00021425]
 [ 0.00020128 -0.00020341]
 [ 0.00020848 -0.00021069]
 [ 0.0002069  -0.00020909]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020884 -0.00021105]
 [ 0.00020567 -0.00020785]
 [ 0.00020989 -0.00021211]
 [ 0.00020901 -0.00021123]
 [ 0.00020954 -0.00021176]
 [ 0.00021147 -0.00021371]
 [ 0.00021534 -0.00021762]
 [ 0.00020708 -0.00020927]
 [ 0.0002113  -0.00021354]
 [ 0.00021182 -0.00021407]
 [ 0.00021305 -0.00021531]
 [ 0.00021692 -0.00021922]
 [ 0.00020585 -0.00020803]
 [ 0.00020426 -0.00020643]
 [ 0.00020356 -0.00020572]
 [ 0.00020303 -0.00020519]
 [ 0.00021305 -0.00021531]
 [ 0.00019864 -0.00020074]
 [ 0.00020673 -0.00020892]
 [ 0.00021639 -0.00021869]
 [ 0.00021552 -0.0002178 ]
 [ 0.00020673 -0.00020892]
 [ 0.00020637 -0.00020856]
 [ 0.00019565 -0.00019772]
 [ 0.00020321 -0.00020536]
 [ 0.00020743 -0.00020963]
 [ 0.00020919 -0.0002114 ]
 [ 0.00020409 -0.00020625]
 [ 0.00019548 -0.00019755]
 [ 0.00020216 -0.0002043 ]
 [ 0.00021253 -0.00021478]
 [ 0.00020884 -0.00021105]
 [ 0.000212   -0.00021425]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020708 -0.00020927]
 [ 0.00020128 -0.00020341]
 [ 0.0002062  -0.00020838]
 [ 0.00021376 -0.00021602]
 [ 0.00021358 -0.00021584]
 [ 0.00020848 -0.00021069]
 [ 0.00019829 -0.00020039]
 [ 0.00021182 -0.00021407]
 [ 0.00020743 -0.00020963]
 [ 0.00020409 -0.00020625]
 [ 0.00019723 -0.00019932]
 [ 0.00021446 -0.00021673]
 [ 0.00020778 -0.00020998]
 [ 0.00020514 -0.00020732]
 [ 0.00020655 -0.00020874]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020971 -0.00021194]
 [ 0.00021341 -0.00021567]
 [ 0.00021639 -0.00021869]
 [ 0.00019618 -0.00019826]
 [ 0.00021094 -0.00021318]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020708 -0.00020927]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021059 -0.00021282]
 [ 0.00019864 -0.00020074]
 [ 0.00020391 -0.00020607]
 [ 0.00021481 -0.00021709]
 [ 0.00019829 -0.00020039]
 [ 0.00020321 -0.00020536]
 [ 0.00020426 -0.00020643]
 [ 0.00020514 -0.00020732]
 [ 0.00021112 -0.00021336]
 [ 0.00020321 -0.00020536]
 [ 0.00021692 -0.00021922]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020936 -0.00021158]
 [ 0.00020532 -0.00020749]
 [ 0.00021534 -0.00021762]
 [ 0.00019917 -0.00020128]
 [ 0.00020585 -0.00020803]
 [ 0.00020514 -0.00020732]
 [ 0.0002055  -0.00020767]
 [ 0.00020725 -0.00020945]
 [ 0.00020479 -0.00020696]
 [ 0.00021147 -0.00021371]
 [ 0.00019794 -0.00020003]
 [ 0.00020145 -0.00020359]
 [ 0.00021534 -0.00021762]
 [ 0.00021411 -0.00021638]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00020936 -0.00021158]
 [ 0.00021376 -0.00021602]
 [ 0.0002113  -0.00021354]
 [ 0.00019811 -0.00020021]
 [ 0.00020286 -0.00020501]
 [ 0.00020532 -0.00020749]
 [ 0.00021218 -0.00021442]
 [ 0.00020884 -0.00021105]
 [ 0.00020936 -0.00021158]
 [ 0.00020954 -0.00021176]
 [ 0.00020514 -0.00020732]
 [ 0.00021288 -0.00021513]
 [ 0.00020831 -0.00021051]
 [ 0.00021182 -0.00021407]
 [ 0.00020303 -0.00020519]
 [ 0.00020585 -0.00020803]
 [ 0.00020796 -0.00021016]
 [ 0.00020954 -0.00021176]
 [ 0.00019934 -0.00020145]
 [ 0.00020022 -0.00020234]
 [ 0.00020233 -0.00020447]
 [ 0.00019864 -0.00020074]
 [ 0.00020813 -0.00021034]
 [ 0.00020954 -0.00021176]
 [ 0.00021481 -0.00021709]
 [ 0.00021165 -0.00021389]
 [ 0.00021464 -0.00021691]
 [ 0.00021112 -0.00021336]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021007 -0.00021229]
 [ 0.00020462 -0.00020678]
 [ 0.000212   -0.00021425]
 [ 0.00020567 -0.00020785]
 [ 0.00021042 -0.00021265]
 [ 0.00019934 -0.00020145]
 [ 0.00021446 -0.00021673]
 [ 0.00020514 -0.00020732]
 [ 0.00021815 -0.00022046]
 [ 0.00020339 -0.00020554]
 [ 0.00021059 -0.00021282]
 [ 0.00020497 -0.00020714]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021323 -0.00021549]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020866 -0.00021087]
 [ 0.0002069  -0.00020909]
 [ 0.00019952 -0.00020163]
 [ 0.000196   -0.00019808]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020303 -0.00020519]
 [ 0.00020655 -0.00020874]
 [ 0.00021657 -0.00021886]
 [ 0.0002004  -0.00020252]
 [ 0.00019987 -0.00020199]
 [ 0.00019723 -0.00019932]
 [ 0.00020286 -0.00020501]
 [ 0.00020989 -0.00021211]
 [ 0.00019671 -0.00019879]
 [ 0.00021692 -0.00021922]
 [ 0.0002127  -0.00021496]
 [ 0.00020233 -0.00020447]
 [ 0.00021464 -0.00021691]
 [ 0.00021481 -0.00021709]
 [ 0.00021094 -0.00021318]
 [ 0.00020989 -0.00021211]
 [ 0.00019776 -0.00019986]
 [ 0.00020848 -0.00021069]
 [ 0.00020321 -0.00020536]
 [ 0.00019882 -0.00020092]
 [ 0.00020936 -0.00021158]
 [ 0.0002062  -0.00020838]
 [ 0.00021147 -0.00021371]
 [ 0.0002018  -0.00020394]
 [ 0.00020426 -0.00020643]
 [ 0.00020286 -0.00020501]
 [ 0.00020901 -0.00021123]
 [ 0.00020321 -0.00020536]
 [ 0.00021481 -0.00021709]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020374 -0.0002059 ]
 [ 0.00019706 -0.00019915]
 [ 0.00020022 -0.00020234]
 [ 0.00020022 -0.00020234]
 [ 0.00019618 -0.00019826]
 [ 0.0002011  -0.00020323]
 [ 0.00020514 -0.00020732]
 [ 0.00020567 -0.00020785]
 [ 0.0002171  -0.0002194 ]
 [ 0.00021745 -0.00021975]
 [ 0.00020198 -0.00020412]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020497 -0.00020714]
 [ 0.00019706 -0.00019915]
 [ 0.00021094 -0.00021318]
 [ 0.00020251 -0.00020465]
 [ 0.00021253 -0.00021478]
 [ 0.00020725 -0.00020945]
 [ 0.00020444 -0.00020661]
 [ 0.00021007 -0.00021229]
 [ 0.00020848 -0.00021069]
 [ 0.00020708 -0.00020927]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.00021094 -0.00021318]
 [ 0.00021042 -0.00021265]
 [ 0.00021094 -0.00021318]
 [ 0.00020409 -0.00020625]
 [ 0.00021639 -0.00021869]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021692 -0.00021922]
 [ 0.00019688 -0.00019897]
 [ 0.00021885 -0.00022117]
 [ 0.00020426 -0.00020643]
 [ 0.00021077 -0.000213  ]
 [ 0.00020479 -0.00020696]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021042 -0.00021265]
 [ 0.0002055  -0.00020767]
 [ 0.00021024 -0.00021247]
 [ 0.00020145 -0.00020359]
 [ 0.00020198 -0.00020412]
 [ 0.00020092 -0.00020305]
 [ 0.00020725 -0.00020945]
 [ 0.00020831 -0.00021051]
 [ 0.00019741 -0.0001995 ]
 [ 0.00020971 -0.00021194]
 [ 0.00020409 -0.00020625]
 [ 0.000212   -0.00021425]
 [ 0.0002113  -0.00021354]
 [ 0.00019671 -0.00019879]
 [ 0.00020743 -0.00020963]
 [ 0.00021288 -0.00021513]
 [ 0.00020743 -0.00020963]
 [ 0.00021147 -0.00021371]
 [ 0.00021182 -0.00021407]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020901 -0.00021123]
 [ 0.00021147 -0.00021371]
 [ 0.00019161 -0.00019364]
 [ 0.00020145 -0.00020359]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00021762 -0.00021993]
 [ 0.00021481 -0.00021709]
 [ 0.00019846 -0.00020057]
 [ 0.00019882 -0.00020092]
 [ 0.00020567 -0.00020785]
 [ 0.00021007 -0.00021229]
 [ 0.0002011  -0.00020323]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020233 -0.00020447]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020444 -0.00020661]
 [ 0.00020128 -0.00020341]
 [ 0.00020426 -0.00020643]
 [ 0.0002062  -0.00020838]
 [ 0.00020057 -0.0002027 ]
 [ 0.00019776 -0.00019986]
 [ 0.00021499 -0.00021727]
 [ 0.00019794 -0.00020003]
 [ 0.00020356 -0.00020572]
 [ 0.00021376 -0.00021602]
 [ 0.0002127  -0.00021496]
 [ 0.00020725 -0.00020945]
 [ 0.0002069  -0.00020909]
 [ 0.00020743 -0.00020963]
 [ 0.00021165 -0.00021389]
 [ 0.0002127  -0.00021496]
 [ 0.0002018  -0.00020394]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00020128 -0.00020341]
 [ 0.00021745 -0.00021975]
 [ 0.00020778 -0.00020998]
 [ 0.00021007 -0.00021229]
 [ 0.00019899 -0.0002011 ]
 [ 0.00021464 -0.00021691]
 [ 0.00021499 -0.00021727]
 [ 0.00020901 -0.00021123]
 [ 0.00020848 -0.00021069]
 [ 0.00020954 -0.00021176]
 [ 0.00021411 -0.00021638]
 [ 0.00020831 -0.00021051]
 [ 0.00020796 -0.00021016]
 [ 0.00021094 -0.00021318]
 [ 0.00020128 -0.00020341]
 [ 0.00020497 -0.00020714]
 [ 0.00021446 -0.00021673]
 [ 0.00021622 -0.00021851]
 [ 0.00021253 -0.00021478]
 [ 0.00019811 -0.00020021]
 [ 0.00021112 -0.00021336]
 [ 0.00021253 -0.00021478]
 [ 0.00020708 -0.00020927]
 [ 0.00021077 -0.000213  ]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00021218 -0.00021442]
 [ 0.0002113  -0.00021354]
 [ 0.00020356 -0.00020572]
 [ 0.00021305 -0.00021531]
 [ 0.00021464 -0.00021691]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020585 -0.00020803]
 [ 0.00020391 -0.00020607]
 [ 0.00021446 -0.00021673]
 [ 0.00020866 -0.00021087]
 [ 0.00020725 -0.00020945]
 [ 0.00020286 -0.00020501]
 [ 0.00020778 -0.00020998]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021024 -0.00021247]
 [ 0.00020602 -0.00020821]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020831 -0.00021051]
 [ 0.0002113  -0.00021354]
 [ 0.00020637 -0.00020856]
 [ 0.00020145 -0.00020359]
 [ 0.00020514 -0.00020732]
 [ 0.00019776 -0.00019986]
 [ 0.00020637 -0.00020856]
 [ 0.00020251 -0.00020465]
 [ 0.00021112 -0.00021336]
 [ 0.00020216 -0.0002043 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020884 -0.00021105]
 [ 0.00021024 -0.00021247]
 [ 0.00021147 -0.00021371]
 [ 0.00020321 -0.00020536]
 [ 0.00020901 -0.00021123]
 [ 0.00020743 -0.00020963]
 [ 0.000196   -0.00019808]
 [ 0.00020198 -0.00020412]
 [ 0.0002069  -0.00020909]
 [ 0.00020567 -0.00020785]
 [ 0.0002069  -0.00020909]
 [ 0.00020796 -0.00021016]
 [ 0.00020778 -0.00020998]
 [ 0.00020145 -0.00020359]
 [ 0.00020655 -0.00020874]
 [ 0.00021604 -0.00021833]
 [ 0.00020198 -0.00020412]
 [ 0.00020901 -0.00021123]
 [ 0.00021569 -0.00021798]
 [ 0.00020936 -0.00021158]
 [ 0.00021024 -0.00021247]
 [ 0.00020409 -0.00020625]
 [ 0.00020848 -0.00021069]
 [ 0.00020444 -0.00020661]
 [ 0.00021112 -0.00021336]
 [ 0.00020655 -0.00020874]
 [ 0.00020637 -0.00020856]
 [ 0.00021165 -0.00021389]
 [ 0.00020848 -0.00021069]
 [ 0.00020989 -0.00021211]
 [ 0.00020708 -0.00020927]
 [ 0.00020884 -0.00021105]
 [ 0.00021534 -0.00021762]
 [ 0.0002011  -0.00020323]
 [ 0.00020409 -0.00020625]
 [ 0.0002018  -0.00020394]
 [ 0.00020391 -0.00020607]
 [ 0.00020444 -0.00020661]
 [ 0.00021604 -0.00021833]
 [ 0.00021112 -0.00021336]
 [ 0.00019846 -0.00020057]
 [ 0.00021288 -0.00021513]
 [ 0.00021042 -0.00021265]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020356 -0.00020572]
 [ 0.00020866 -0.00021087]
 [ 0.0002011  -0.00020323]
 [ 0.00020954 -0.00021176]
 [ 0.00020796 -0.00021016]
 [ 0.00021622 -0.00021851]
 [ 0.00020602 -0.00020821]
 [ 0.0002113  -0.00021354]
 [ 0.00021499 -0.00021727]
 [ 0.00020848 -0.00021069]
 [ 0.00021868 -0.000221  ]
 [ 0.00020831 -0.00021051]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020813 -0.00021034]
 [ 0.00021042 -0.00021265]
 [ 0.00020708 -0.00020927]
 [ 0.0002004  -0.00020252]
 [ 0.00020884 -0.00021105]
 [ 0.00020725 -0.00020945]
 [ 0.00020321 -0.00020536]
 [ 0.00019214 -0.00019417]
 [ 0.0002018  -0.00020394]
 [ 0.00020444 -0.00020661]
 [ 0.00020919 -0.0002114 ]
 [ 0.00021042 -0.00021265]
 [ 0.00021323 -0.00021549]
 [ 0.00019618 -0.00019826]
 [ 0.00020409 -0.00020625]
 [ 0.00020321 -0.00020536]
 [ 0.00020919 -0.0002114 ]
 [ 0.0002011  -0.00020323]
 [ 0.00021358 -0.00021584]
 [ 0.00020831 -0.00021051]
 [ 0.00021569 -0.00021798]
 [ 0.00020813 -0.00021034]
 [ 0.00020971 -0.00021194]
 [ 0.00020567 -0.00020785]
 [ 0.00020725 -0.00020945]
 [ 0.00020233 -0.00020447]
 [ 0.0002055  -0.00020767]
 [ 0.00020286 -0.00020501]
 [ 0.00019846 -0.00020057]
 [ 0.00020479 -0.00020696]
 [ 0.00020339 -0.00020554]
 [ 0.00020901 -0.00021123]
 [ 0.00020919 -0.0002114 ]
 [ 0.00019987 -0.00020199]
 [ 0.00020936 -0.00021158]
 [ 0.00021464 -0.00021691]
 [ 0.00020286 -0.00020501]
 [ 0.00020514 -0.00020732]
 [ 0.00020971 -0.00021194]
 [ 0.00020251 -0.00020465]
 [ 0.00020831 -0.00021051]
 [ 0.00020532 -0.00020749]
 [ 0.00021411 -0.00021638]
 [ 0.00021077 -0.000213  ]
 [ 0.00021604 -0.00021833]
 [ 0.00020321 -0.00020536]
 [ 0.00021411 -0.00021638]
 [ 0.00021182 -0.00021407]
 [ 0.00020954 -0.00021176]
 [ 0.00020971 -0.00021194]
 [ 0.00020514 -0.00020732]
 [ 0.00020585 -0.00020803]
 [ 0.00020005 -0.00020217]
 [ 0.00019987 -0.00020199]
 [ 0.00020022 -0.00020234]]
positive mean=0.00021355401258915663, std=7.162120709836017e-06
negative mean=0.0002946807653643191, std=7.565464784420328e-06
predicted_label: [1 0 0 0 1]
y: [0 1 1 1 0]
batch_size=1024,class_num=2,acc=0.000000,time_used=0.460742
returning from NormbasedScoring
norm_leak_acc: 0.0
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|1|3|NormbasedScoring|None|0.9985815602836879|0.0|0.0
================= iter seed  101  =================
===== No Defense ======
running on cuda0
============ apply_trainable_layer= 0 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/0/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.03 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|0|3|No_Attack|None|0.9985815602836879|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[ 0.00057484 -0.00057484]
 [ 0.00065996 -0.00065996]
 [ 0.00062259 -0.00062259]
 ...
 [ 0.0005796  -0.0005796 ]
 [ 0.00068723 -0.00068723]
 [ 0.00058507 -0.00058507]]
negative gradients:[[-0.00042681  0.00042681]
 [-0.00044697  0.00044697]
 [-0.00038917  0.00038917]
 [-0.00032798  0.00032798]
 [-0.00056932  0.00056932]
 [-0.00039029  0.00039029]
 [-0.00049318  0.00049318]
 [-0.00047019  0.00047019]
 [-0.00029324  0.00029324]
 [-0.00038557  0.00038557]
 [-0.00046396  0.00046396]
 [-0.00032651  0.00032651]
 [-0.00040741  0.00040741]
 [-0.00028358  0.00028358]
 [-0.00041462  0.00041462]
 [-0.00028323  0.00028323]
 [-0.000442    0.000442  ]
 [-0.00054215  0.00054215]
 [-0.00037087  0.00037087]
 [-0.00042156  0.00042156]
 [-0.00039187  0.00039187]
 [-0.00029333  0.00029333]
 [-0.00049156  0.00049156]
 [-0.00029422  0.00029422]
 [-0.00033399  0.00033399]
 [-0.00040541  0.00040541]
 [-0.00038933  0.00038933]
 [-0.00035142  0.00035142]
 [-0.00047145  0.00047145]
 [-0.00040431  0.00040431]
 [-0.00043601  0.00043601]
 [-0.00055318  0.00055318]
 [-0.00034701  0.00034701]
 [-0.00031467  0.00031467]
 [-0.00044352  0.00044352]
 [-0.00035963  0.00035963]
 [-0.00026628  0.00026628]
 [-0.00048649  0.00048649]
 [-0.00042396  0.00042396]
 [-0.00040799  0.00040799]
 [-0.00034472  0.00034472]
 [-0.00043283  0.00043283]
 [-0.00038601  0.00038601]
 [-0.00042811  0.00042811]
 [-0.00028449  0.00028449]
 [-0.00041851  0.00041851]
 [-0.00034686  0.00034686]
 [-0.00044466  0.00044466]
 [-0.00033768  0.00033768]
 [-0.00038065  0.00038065]
 [-0.00045124  0.00045124]
 [-0.00044326  0.00044326]
 [-0.0002292   0.0002292 ]
 [-0.00036279  0.00036279]
 [-0.00040427  0.00040427]
 [-0.00039111  0.00039111]
 [-0.00047004  0.00047004]
 [-0.00047519  0.00047519]
 [-0.00038312  0.00038312]
 [-0.00044803  0.00044803]
 [-0.00022418  0.00022418]
 [-0.00046128  0.00046128]
 [-0.00037419  0.00037419]
 [-0.0004176   0.0004176 ]
 [-0.00036632  0.00036632]
 [-0.00041903  0.00041903]
 [-0.00039386  0.00039386]
 [-0.00044411  0.00044411]
 [-0.00047412  0.00047412]
 [-0.00041633  0.00041633]
 [-0.00039719  0.00039719]
 [-0.00041573  0.00041573]
 [-0.00046351  0.0004635 ]
 [-0.00032183  0.00032183]
 [-0.00038721  0.00038721]
 [-0.00047472  0.00047472]
 [-0.00028578  0.00028578]
 [-0.00042783  0.00042783]
 [-0.00043541  0.00043541]
 [-0.00035687  0.00035687]
 [-0.00045109  0.00045109]
 [-0.00041873  0.00041873]
 [-0.000364    0.000364  ]
 [-0.00033198  0.00033198]
 [-0.00044988  0.00044988]
 [-0.00038613  0.00038613]
 [-0.00032881  0.00032881]
 [-0.00038398  0.00038398]
 [-0.00033989  0.00033989]
 [-0.00045999  0.00045999]
 [-0.00039781  0.00039781]
 [-0.00038743  0.00038743]
 [-0.00040561  0.00040561]
 [-0.00033825  0.00033825]
 [-0.0004075   0.0004075 ]
 [-0.00045867  0.00045867]
 [-0.00044503  0.00044503]
 [-0.00050015  0.00050015]
 [-0.00041797  0.00041797]
 [-0.00047443  0.00047443]
 [-0.00042458  0.00042458]
 [-0.0004066   0.0004066 ]
 [-0.00037113  0.00037113]
 [-0.00040555  0.00040555]
 [-0.00039363  0.00039363]
 [-0.00025421  0.00025421]
 [-0.00042694  0.00042694]
 [-0.00034547  0.00034547]
 [-0.00030403  0.00030403]
 [-0.00037448  0.00037448]
 [-0.00043516  0.00043516]
 [-0.00036706  0.00036706]
 [-0.00050569  0.00050569]
 [-0.00043357  0.00043357]
 [-0.00039162  0.00039162]
 [-0.0003681   0.0003681 ]
 [-0.00038517  0.00038517]
 [-0.00045285  0.00045285]
 [-0.0002668   0.0002668 ]
 [-0.00036604  0.00036604]
 [-0.0003977   0.0003977 ]
 [-0.0003825   0.0003825 ]
 [-0.00042053  0.00042053]
 [-0.00043243  0.00043243]
 [-0.00043013  0.00043013]
 [-0.00038186  0.00038186]
 [-0.00033904  0.00033904]
 [-0.00032903  0.00032903]
 [-0.00029261  0.00029261]
 [-0.00041094  0.00041094]
 [-0.00032471  0.00032471]
 [-0.00047841  0.00047841]
 [-0.00038477  0.00038477]
 [-0.00035788  0.00035788]
 [-0.00041071  0.00041071]
 [-0.00042025  0.00042025]
 [-0.00022072  0.00022072]
 [-0.00035906  0.00035906]
 [-0.00037584  0.00037584]
 [-0.00029287  0.00029287]
 [-0.00036739  0.00036739]
 [-0.00048578  0.00048578]
 [-0.00028889  0.00028889]
 [-0.0003642   0.0003642 ]
 [-0.00028525  0.00028525]
 [-0.00040643  0.00040643]
 [-0.00043758  0.00043758]
 [-0.00046208  0.00046208]
 [-0.00040728  0.00040728]
 [-0.00037574  0.00037574]
 [-0.0002899   0.0002899 ]
 [-0.00046013  0.00046013]
 [-0.00048016  0.00048016]
 [-0.00044724  0.00044724]
 [-0.00039829  0.00039829]
 [-0.00030298  0.00030298]
 [-0.00042895  0.00042895]
 [-0.0002955   0.0002955 ]
 [-0.00042838  0.00042838]
 [-0.00039908  0.00039908]
 [-0.00040751  0.00040751]
 [-0.00041797  0.00041797]
 [-0.0004014   0.0004014 ]
 [-0.0004034   0.0004034 ]
 [-0.00048214  0.00048214]
 [-0.00042106  0.00042106]
 [-0.00042505  0.00042505]
 [-0.00038711  0.00038711]
 [-0.00048209  0.00048209]
 [-0.0003426   0.0003426 ]
 [-0.00031054  0.00031054]
 [-0.00032848  0.00032848]
 [-0.0003111   0.0003111 ]
 [-0.00037478  0.00037478]
 [-0.00043799  0.00043799]
 [-0.00042572  0.00042572]
 [-0.00040968  0.00040968]
 [-0.00037909  0.00037909]
 [-0.00044946  0.00044946]
 [-0.00040487  0.00040487]
 [-0.00038792  0.00038792]
 [-0.00042355  0.00042355]
 [-0.00034607  0.00034607]
 [-0.00042593  0.00042593]
 [-0.0004133   0.0004133 ]
 [-0.00042703  0.00042703]
 [-0.00036948  0.00036948]
 [-0.00029227  0.00029227]
 [-0.00044211  0.00044211]
 [-0.00029614  0.00029614]
 [-0.00039748  0.00039748]
 [-0.00039985  0.00039985]
 [-0.00044125  0.00044125]
 [-0.00053102  0.00053102]
 [-0.00035284  0.00035284]
 [-0.00037822  0.00037822]
 [-0.00044208  0.00044208]
 [-0.00048696  0.00048696]
 [-0.00026907  0.00026907]
 [-0.00036626  0.00036626]
 [-0.00041851  0.00041851]
 [-0.00039531  0.00039531]
 [-0.0003491   0.0003491 ]
 [-0.00049916  0.00049916]
 [-0.00041517  0.00041517]
 [-0.0004263   0.0004263 ]
 [-0.00031952  0.00031952]
 [-0.00031904  0.00031904]
 [-0.00046262  0.00046262]
 [-0.00027082  0.00027082]
 [-0.00026967  0.00026967]
 [-0.00036833  0.00036833]
 [-0.00036507  0.00036507]
 [-0.00046861  0.00046861]
 [-0.00037975  0.00037975]
 [-0.00041069  0.00041069]
 [-0.00035686  0.00035686]
 [-0.00042097  0.00042097]
 [-0.0004651   0.0004651 ]
 [-0.00035135  0.00035135]
 [-0.00039958  0.00039958]
 [-0.00045761  0.00045761]
 [-0.00025429  0.00025429]
 [-0.00035787  0.00035787]
 [-0.00026199  0.00026199]
 [-0.00032026  0.00032026]
 [-0.00043012  0.00043012]
 [-0.00045402  0.00045402]
 [-0.0003786   0.0003786 ]
 [-0.00035185  0.00035185]
 [-0.00048354  0.00048354]
 [-0.00028279  0.00028279]
 [-0.00028481  0.00028481]
 [-0.0004393   0.0004393 ]
 [-0.00036539  0.00036539]
 [-0.00046448  0.00046448]
 [-0.00032975  0.00032975]
 [-0.00032234  0.00032234]
 [-0.00028602  0.00028602]
 [-0.0003823   0.0003823 ]
 [-0.00048689  0.00048689]
 [-0.00031817  0.00031817]
 [-0.00039856  0.00039856]
 [-0.00046914  0.00046914]
 [-0.00025062  0.00025062]
 [-0.00056553  0.00056553]
 [-0.00033154  0.00033154]
 [-0.00032595  0.00032595]
 [-0.00044032  0.00044032]
 [-0.00048961  0.00048961]
 [-0.00047534  0.00047534]
 [-0.00036009  0.00036009]
 [-0.00045148  0.00045148]
 [-0.00018238  0.00018238]
 [-0.00026585  0.00026585]
 [-0.0004916   0.0004916 ]
 [-0.00044697  0.00044697]
 [-0.00043708  0.00043708]
 [-0.00036491  0.00036491]
 [-0.00025122  0.00025122]
 [-0.00046703  0.00046703]
 [-0.00044913  0.00044913]
 [-0.00041634  0.00041634]
 [-0.0004546   0.0004546 ]
 [-0.00040814  0.00040814]
 [-0.00045336  0.00045336]
 [-0.00031912  0.00031912]
 [-0.0004557   0.0004557 ]
 [-0.00036484  0.00036484]
 [-0.00045634  0.00045634]
 [-0.0003805   0.0003805 ]
 [-0.0004456   0.0004456 ]
 [-0.00037388  0.00037388]
 [-0.00046105  0.00046105]
 [-0.00019214  0.00019214]
 [-0.00048215  0.00048215]
 [-0.00038042  0.00038042]
 [-0.00043109  0.00043109]
 [-0.00045437  0.00045437]
 [-0.00034663  0.00034663]
 [-0.00031026  0.00031026]
 [-0.00042121  0.00042121]
 [-0.00045268  0.00045268]
 [-0.00030421  0.00030421]
 [-0.00024117  0.00024117]
 [-0.00033782  0.00033782]
 [-0.00033904  0.00033904]
 [-0.00041267  0.00041267]
 [-0.00033527  0.00033527]
 [-0.00035226  0.00035226]
 [-0.00038781  0.00038781]
 [-0.00033385  0.00033385]
 [-0.00048688  0.00048688]
 [-0.00043333  0.00043333]
 [-0.00032736  0.00032736]
 [-0.00039613  0.00039613]
 [-0.00038248  0.00038248]
 [-0.00045995  0.00045995]
 [-0.00030263  0.00030263]
 [-0.00038149  0.00038149]
 [-0.00043218  0.00043218]
 [-0.000417    0.000417  ]
 [-0.00028759  0.00028759]
 [-0.00037613  0.00037613]
 [-0.00045782  0.00045782]
 [-0.00036289  0.00036289]
 [-0.00043142  0.00043142]
 [-0.0004331   0.0004331 ]
 [-0.00028066  0.00028066]
 [-0.0004165   0.0004165 ]
 [-0.00060796  0.00060796]
 [-0.00033708  0.00033708]
 [-0.00050356  0.00050356]
 [-0.00032556  0.00032556]
 [-0.00036827  0.00036827]
 [-0.00034654  0.00034654]
 [-0.00039092  0.00039092]
 [-0.0005093   0.0005093 ]
 [-0.00044447  0.00044447]
 [-0.00039999  0.00039999]
 [-0.00034639  0.00034639]
 [-0.00051428  0.00051428]
 [-0.00040516  0.00040516]
 [-0.00036177  0.00036177]
 [-0.00044773  0.00044773]
 [-0.00039983  0.00039983]
 [-0.00020779  0.00020779]
 [-0.00040054  0.00040054]
 [-0.00045269  0.00045269]
 [-0.00041696  0.00041696]
 [-0.00036408  0.00036408]
 [-0.00038325  0.00038325]
 [-0.00039183  0.00039183]
 [-0.00037081  0.00037081]
 [-0.00047809  0.00047809]
 [-0.00032617  0.00032617]
 [-0.00042363  0.00042363]
 [-0.00042255  0.00042255]
 [-0.00047964  0.00047964]
 [-0.00041185  0.00041185]
 [-0.00039408  0.00039408]
 [-0.00034587  0.00034587]
 [-0.00059824  0.00059824]
 [-0.00044423  0.00044423]
 [-0.000388    0.000388  ]
 [-0.00034077  0.00034077]
 [-0.00032355  0.00032355]
 [-0.00023504  0.00023504]
 [-0.00035973  0.00035973]
 [-0.00047131  0.00047131]
 [-0.00043     0.00043   ]
 [-0.00044179  0.00044179]
 [-0.0004206   0.0004206 ]
 [-0.00031413  0.00031413]
 [-0.0004081   0.0004081 ]
 [-0.0004094   0.0004094 ]
 [-0.00042668  0.00042668]
 [-0.00050458  0.00050458]
 [-0.00035595  0.00035595]
 [-0.00032941  0.00032941]
 [-0.00042785  0.00042785]
 [-0.00063391  0.00063391]
 [-0.00029892  0.00029892]
 [-0.00043425  0.00043425]
 [-0.00026971  0.00026971]
 [-0.00034927  0.00034927]
 [-0.00038621  0.00038621]
 [-0.00036125  0.00036125]
 [-0.00044144  0.00044144]
 [-0.00040274  0.00040274]
 [-0.00041735  0.00041735]
 [-0.00038274  0.00038274]
 [-0.00037469  0.00037469]
 [-0.00029838  0.00029838]
 [-0.00040634  0.00040634]
 [-0.0004327   0.0004327 ]
 [-0.00048136  0.00048136]
 [-0.00049029  0.00049029]
 [-0.00028847  0.00028847]
 [-0.00032049  0.00032049]
 [-0.00032392  0.00032392]
 [-0.00041895  0.00041895]
 [-0.00035219  0.00035219]
 [-0.0004399   0.0004399 ]
 [-0.00040591  0.00040591]
 [-0.00026472  0.00026472]
 [-0.00030627  0.00030627]
 [-0.00030405  0.00030405]
 [-0.00044344  0.00044344]
 [-0.00045772  0.00045772]
 [-0.00051885  0.00051885]
 [-0.00029819  0.00029819]
 [-0.00031873  0.00031873]
 [-0.00030277  0.00030277]
 [-0.0004365   0.0004365 ]
 [-0.00047159  0.00047159]
 [-0.00027409  0.00027409]
 [-0.00040064  0.00040064]
 [-0.00028161  0.00028161]
 [-0.00042879  0.00042879]
 [-0.00029544  0.00029544]
 [-0.00026384  0.00026384]
 [-0.00044222  0.00044222]
 [-0.0002614   0.0002614 ]
 [-0.00033148  0.00033148]
 [-0.00032201  0.00032201]
 [-0.00040319  0.00040319]
 [-0.00029084  0.00029084]
 [-0.0003877   0.0003877 ]
 [-0.00041835  0.00041835]
 [-0.0003494   0.0003494 ]
 [-0.00036331  0.00036331]
 [-0.000419    0.000419  ]
 [-0.00035278  0.00035278]
 [-0.0003789   0.0003789 ]
 [-0.00040142  0.00040142]
 [-0.00030551  0.00030551]
 [-0.00032377  0.00032377]
 [-0.00044341  0.00044341]
 [-0.0003552   0.0003552 ]
 [-0.00049263  0.00049263]
 [-0.00031829  0.00031829]
 [-0.00045915  0.00045915]
 [-0.00050682  0.00050682]
 [-0.00043015  0.00043015]
 [-0.00035278  0.00035278]
 [-0.00047734  0.00047734]
 [-0.00051308  0.00051308]
 [-0.00038996  0.00038996]
 [-0.0003758   0.0003758 ]
 [-0.0003954   0.0003954 ]
 [-0.00026045  0.00026045]
 [-0.00038306  0.00038306]
 [-0.00047509  0.00047509]
 [-0.00034386  0.00034386]
 [-0.00033399  0.00033399]
 [-0.00051174  0.00051174]
 [-0.00038757  0.00038757]
 [-0.00044337  0.00044337]
 [-0.00027823  0.00027823]
 [-0.00041047  0.00041047]
 [-0.0002333   0.0002333 ]
 [-0.0005355   0.0005355 ]
 [-0.00027487  0.00027487]
 [-0.00032935  0.00032935]
 [-0.0005221   0.0005221 ]
 [-0.00036941  0.00036941]
 [-0.00052309  0.00052309]
 [-0.00035298  0.00035298]
 [-0.00025304  0.00025304]
 [-0.00039181  0.00039181]
 [-0.00036161  0.00036161]
 [-0.00037001  0.00037001]
 [-0.0004073   0.0004073 ]
 [-0.00045176  0.00045176]
 [-0.00028138  0.00028138]
 [-0.00025998  0.00025998]
 [-0.00031167  0.00031167]
 [-0.00020808  0.00020808]
 [-0.00047484  0.00047484]
 [-0.00038131  0.00038131]
 [-0.00047819  0.00047819]
 [-0.00044441  0.00044441]
 [-0.00041854  0.00041854]
 [-0.00030864  0.00030864]
 [-0.00039807  0.00039807]
 [-0.00041727  0.00041727]
 [-0.00040847  0.00040847]
 [-0.00023359  0.00023359]
 [-0.00052703  0.00052703]
 [-0.0002737   0.0002737 ]
 [-0.00045688  0.00045688]
 [-0.00032323  0.00032323]
 [-0.00027024  0.00027024]
 [-0.00037336  0.00037336]
 [-0.00041543  0.00041543]
 [-0.00040901  0.00040901]
 [-0.00037072  0.00037072]
 [-0.00046118  0.00046118]
 [-0.00040398  0.00040398]
 [-0.0003746   0.0003746 ]
 [-0.00028367  0.00028367]
 [-0.000299    0.000299  ]
 [-0.00055176  0.00055176]
 [-0.00045169  0.00045169]
 [-0.00027639  0.00027639]
 [-0.00034195  0.00034195]
 [-0.00038649  0.00038649]
 [-0.00040437  0.00040437]]
positive mean=0.0008789387647993863, std=7.920056668808684e-05
negative mean=0.0005505415028892457, std=0.00010146816202905029
predicted_label: [0 0 1 1 0]
y: [0 0 1 1 0]
batch_size=1024,class_num=2,acc=0.963867,time_used=0.218198
returning from NormbasedScoring
norm_leak_acc: 0.9638671875
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|0|3|NormbasedScoring|None|0.9985815602836879|0.9638671875|0.9952869674903962
============ apply_trainable_layer= 1 ============
======= Defense ========
Defense_Name: None
Defense_Config: None
===== Total Attack Tested: 1  ======
targeted_backdoor: [] []
untargeted_backdoor: [] []
label_inference: ['NormbasedScoring'] [0]
feature_inference: [] []
exp_result/mnist/Q1/1/None_None,model=MLP2.txt
=================================

No Attack==============================
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
validate and test
Epoch 0% 	 train_loss:0.02 train_acc:0.99 test_acc:1.00
validate and test
Epoch 1% 	 train_loss:0.03 train_acc:0.99 test_acc:1.00
validate and test
Epoch 2% 	 train_loss:0.00 train_acc:1.00 test_acc:1.00
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|acc_loss,2|1024|0.010000|2|1|1|3|No_Attack|None|0.9985815602836879|0.0
======= Test Attack 0 :  NormbasedScoring  =======
attack configs: {'party': [0]}
load_dataset_per_party  args.need_auxiliary =  0
Load Defense models
load_dataset_per_party  args.need_auxiliary =  0
global_model ClassificationModelHostTrainableHead
Load Defense models
init pos_idx: 510 tensor(1, device='cuda:0')
true_label: torch.Size([1024, 2]) 1024
tf_true_label: (1024,)
tf_pred_a_gradients_clone: (1024, 2)
pos_idx: 510
tf_pred_a_gradients_clone[pos_idx:pos_idx+1]: (1, 2)
positive gradients:[[-0.00016137  0.00016308]
 [-0.00015276  0.00015438]
 [-0.00014836  0.00014994]
 ...
 [-0.00015241  0.00015402]
 [-0.00014582  0.00014736]
 [-0.00015232  0.00015393]]
negative gradients:[[ 0.000212   -0.00021425]
 [ 0.00021516 -0.00021744]
 [ 0.00021147 -0.00021371]
 [ 0.00021024 -0.00021247]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020022 -0.00020234]
 [ 0.00021464 -0.00021691]
 [ 0.00020866 -0.00021087]
 [ 0.00020303 -0.00020519]
 [ 0.00020778 -0.00020998]
 [ 0.00020057 -0.0002027 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020708 -0.00020927]
 [ 0.00021305 -0.00021531]
 [ 0.0002004  -0.00020252]
 [ 0.00020497 -0.00020714]
 [ 0.00020163 -0.00020376]
 [ 0.00021288 -0.00021513]
 [ 0.00020813 -0.00021034]
 [ 0.00019882 -0.00020092]
 [ 0.00020462 -0.00020678]
 [ 0.00019565 -0.00019772]
 [ 0.00020585 -0.00020803]
 [ 0.00020409 -0.00020625]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00021253 -0.00021478]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.000212   -0.00021425]
 [ 0.00020128 -0.00020341]
 [ 0.00020848 -0.00021069]
 [ 0.0002069  -0.00020909]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020884 -0.00021105]
 [ 0.00020567 -0.00020785]
 [ 0.00020989 -0.00021211]
 [ 0.00020901 -0.00021123]
 [ 0.00020954 -0.00021176]
 [ 0.00021147 -0.00021371]
 [ 0.00021534 -0.00021762]
 [ 0.00020708 -0.00020927]
 [ 0.0002113  -0.00021354]
 [ 0.00021182 -0.00021407]
 [ 0.00021305 -0.00021531]
 [ 0.00021692 -0.00021922]
 [ 0.00020585 -0.00020803]
 [ 0.00020426 -0.00020643]
 [ 0.00020356 -0.00020572]
 [ 0.00020303 -0.00020519]
 [ 0.00021305 -0.00021531]
 [ 0.00019864 -0.00020074]
 [ 0.00020673 -0.00020892]
 [ 0.00021639 -0.00021869]
 [ 0.00021552 -0.0002178 ]
 [ 0.00020673 -0.00020892]
 [ 0.00020637 -0.00020856]
 [ 0.00019565 -0.00019772]
 [ 0.00020321 -0.00020536]
 [ 0.00020743 -0.00020963]
 [ 0.00020919 -0.0002114 ]
 [ 0.00020409 -0.00020625]
 [ 0.00019548 -0.00019755]
 [ 0.00020216 -0.0002043 ]
 [ 0.00021253 -0.00021478]
 [ 0.00020884 -0.00021105]
 [ 0.000212   -0.00021425]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020708 -0.00020927]
 [ 0.00020128 -0.00020341]
 [ 0.0002062  -0.00020838]
 [ 0.00021376 -0.00021602]
 [ 0.00021358 -0.00021584]
 [ 0.00020848 -0.00021069]
 [ 0.00019829 -0.00020039]
 [ 0.00021182 -0.00021407]
 [ 0.00020743 -0.00020963]
 [ 0.00020409 -0.00020625]
 [ 0.00019723 -0.00019932]
 [ 0.00021446 -0.00021673]
 [ 0.00020778 -0.00020998]
 [ 0.00020514 -0.00020732]
 [ 0.00020655 -0.00020874]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020971 -0.00021194]
 [ 0.00021341 -0.00021567]
 [ 0.00021639 -0.00021869]
 [ 0.00019618 -0.00019826]
 [ 0.00021094 -0.00021318]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020708 -0.00020927]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021059 -0.00021282]
 [ 0.00019864 -0.00020074]
 [ 0.00020391 -0.00020607]
 [ 0.00021481 -0.00021709]
 [ 0.00019829 -0.00020039]
 [ 0.00020321 -0.00020536]
 [ 0.00020426 -0.00020643]
 [ 0.00020514 -0.00020732]
 [ 0.00021112 -0.00021336]
 [ 0.00020321 -0.00020536]
 [ 0.00021692 -0.00021922]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020936 -0.00021158]
 [ 0.00020532 -0.00020749]
 [ 0.00021534 -0.00021762]
 [ 0.00019917 -0.00020128]
 [ 0.00020585 -0.00020803]
 [ 0.00020514 -0.00020732]
 [ 0.0002055  -0.00020767]
 [ 0.00020725 -0.00020945]
 [ 0.00020479 -0.00020696]
 [ 0.00021147 -0.00021371]
 [ 0.00019794 -0.00020003]
 [ 0.00020145 -0.00020359]
 [ 0.00021534 -0.00021762]
 [ 0.00021411 -0.00021638]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00020936 -0.00021158]
 [ 0.00021376 -0.00021602]
 [ 0.0002113  -0.00021354]
 [ 0.00019811 -0.00020021]
 [ 0.00020286 -0.00020501]
 [ 0.00020532 -0.00020749]
 [ 0.00021218 -0.00021442]
 [ 0.00020884 -0.00021105]
 [ 0.00020936 -0.00021158]
 [ 0.00020954 -0.00021176]
 [ 0.00020514 -0.00020732]
 [ 0.00021288 -0.00021513]
 [ 0.00020831 -0.00021051]
 [ 0.00021182 -0.00021407]
 [ 0.00020303 -0.00020519]
 [ 0.00020585 -0.00020803]
 [ 0.00020796 -0.00021016]
 [ 0.00020954 -0.00021176]
 [ 0.00019934 -0.00020145]
 [ 0.00020022 -0.00020234]
 [ 0.00020233 -0.00020447]
 [ 0.00019864 -0.00020074]
 [ 0.00020813 -0.00021034]
 [ 0.00020954 -0.00021176]
 [ 0.00021481 -0.00021709]
 [ 0.00021165 -0.00021389]
 [ 0.00021464 -0.00021691]
 [ 0.00021112 -0.00021336]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021007 -0.00021229]
 [ 0.00020462 -0.00020678]
 [ 0.000212   -0.00021425]
 [ 0.00020567 -0.00020785]
 [ 0.00021042 -0.00021265]
 [ 0.00019934 -0.00020145]
 [ 0.00021446 -0.00021673]
 [ 0.00020514 -0.00020732]
 [ 0.00021815 -0.00022046]
 [ 0.00020339 -0.00020554]
 [ 0.00021059 -0.00021282]
 [ 0.00020497 -0.00020714]
 [ 0.00021393 -0.0002162 ]
 [ 0.00021323 -0.00021549]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020866 -0.00021087]
 [ 0.0002069  -0.00020909]
 [ 0.00019952 -0.00020163]
 [ 0.000196   -0.00019808]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020303 -0.00020519]
 [ 0.00020655 -0.00020874]
 [ 0.00021657 -0.00021886]
 [ 0.0002004  -0.00020252]
 [ 0.00019987 -0.00020199]
 [ 0.00019723 -0.00019932]
 [ 0.00020286 -0.00020501]
 [ 0.00020989 -0.00021211]
 [ 0.00019671 -0.00019879]
 [ 0.00021692 -0.00021922]
 [ 0.0002127  -0.00021496]
 [ 0.00020233 -0.00020447]
 [ 0.00021464 -0.00021691]
 [ 0.00021481 -0.00021709]
 [ 0.00021094 -0.00021318]
 [ 0.00020989 -0.00021211]
 [ 0.00019776 -0.00019986]
 [ 0.00020848 -0.00021069]
 [ 0.00020321 -0.00020536]
 [ 0.00019882 -0.00020092]
 [ 0.00020936 -0.00021158]
 [ 0.0002062  -0.00020838]
 [ 0.00021147 -0.00021371]
 [ 0.0002018  -0.00020394]
 [ 0.00020426 -0.00020643]
 [ 0.00020286 -0.00020501]
 [ 0.00020901 -0.00021123]
 [ 0.00020321 -0.00020536]
 [ 0.00021481 -0.00021709]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020374 -0.0002059 ]
 [ 0.00019706 -0.00019915]
 [ 0.00020022 -0.00020234]
 [ 0.00020022 -0.00020234]
 [ 0.00019618 -0.00019826]
 [ 0.0002011  -0.00020323]
 [ 0.00020514 -0.00020732]
 [ 0.00020567 -0.00020785]
 [ 0.0002171  -0.0002194 ]
 [ 0.00021745 -0.00021975]
 [ 0.00020198 -0.00020412]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020497 -0.00020714]
 [ 0.00019706 -0.00019915]
 [ 0.00021094 -0.00021318]
 [ 0.00020251 -0.00020465]
 [ 0.00021253 -0.00021478]
 [ 0.00020725 -0.00020945]
 [ 0.00020444 -0.00020661]
 [ 0.00021007 -0.00021229]
 [ 0.00020848 -0.00021069]
 [ 0.00020708 -0.00020927]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00020022 -0.00020234]
 [ 0.00020725 -0.00020945]
 [ 0.00021094 -0.00021318]
 [ 0.00021042 -0.00021265]
 [ 0.00021094 -0.00021318]
 [ 0.00020409 -0.00020625]
 [ 0.00021639 -0.00021869]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021692 -0.00021922]
 [ 0.00019688 -0.00019897]
 [ 0.00021885 -0.00022117]
 [ 0.00020426 -0.00020643]
 [ 0.00021077 -0.000213  ]
 [ 0.00020479 -0.00020696]
 [ 0.00020374 -0.0002059 ]
 [ 0.00021042 -0.00021265]
 [ 0.0002055  -0.00020767]
 [ 0.00021024 -0.00021247]
 [ 0.00020145 -0.00020359]
 [ 0.00020198 -0.00020412]
 [ 0.00020092 -0.00020305]
 [ 0.00020725 -0.00020945]
 [ 0.00020831 -0.00021051]
 [ 0.00019741 -0.0001995 ]
 [ 0.00020971 -0.00021194]
 [ 0.00020409 -0.00020625]
 [ 0.000212   -0.00021425]
 [ 0.0002113  -0.00021354]
 [ 0.00019671 -0.00019879]
 [ 0.00020743 -0.00020963]
 [ 0.00021288 -0.00021513]
 [ 0.00020743 -0.00020963]
 [ 0.00021147 -0.00021371]
 [ 0.00021182 -0.00021407]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020901 -0.00021123]
 [ 0.00021147 -0.00021371]
 [ 0.00019161 -0.00019364]
 [ 0.00020145 -0.00020359]
 [ 0.00021007 -0.00021229]
 [ 0.00020884 -0.00021105]
 [ 0.00021762 -0.00021993]
 [ 0.00021481 -0.00021709]
 [ 0.00019846 -0.00020057]
 [ 0.00019882 -0.00020092]
 [ 0.00020567 -0.00020785]
 [ 0.00021007 -0.00021229]
 [ 0.0002011  -0.00020323]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020233 -0.00020447]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021165 -0.00021389]
 [ 0.00020444 -0.00020661]
 [ 0.00020128 -0.00020341]
 [ 0.00020426 -0.00020643]
 [ 0.0002062  -0.00020838]
 [ 0.00020057 -0.0002027 ]
 [ 0.00019776 -0.00019986]
 [ 0.00021499 -0.00021727]
 [ 0.00019794 -0.00020003]
 [ 0.00020356 -0.00020572]
 [ 0.00021376 -0.00021602]
 [ 0.0002127  -0.00021496]
 [ 0.00020725 -0.00020945]
 [ 0.0002069  -0.00020909]
 [ 0.00020743 -0.00020963]
 [ 0.00021165 -0.00021389]
 [ 0.0002127  -0.00021496]
 [ 0.0002018  -0.00020394]
 [ 0.0002055  -0.00020767]
 [ 0.00020233 -0.00020447]
 [ 0.00020128 -0.00020341]
 [ 0.00021745 -0.00021975]
 [ 0.00020778 -0.00020998]
 [ 0.00021007 -0.00021229]
 [ 0.00019899 -0.0002011 ]
 [ 0.00021464 -0.00021691]
 [ 0.00021499 -0.00021727]
 [ 0.00020901 -0.00021123]
 [ 0.00020848 -0.00021069]
 [ 0.00020954 -0.00021176]
 [ 0.00021411 -0.00021638]
 [ 0.00020831 -0.00021051]
 [ 0.00020796 -0.00021016]
 [ 0.00021094 -0.00021318]
 [ 0.00020128 -0.00020341]
 [ 0.00020497 -0.00020714]
 [ 0.00021446 -0.00021673]
 [ 0.00021622 -0.00021851]
 [ 0.00021253 -0.00021478]
 [ 0.00019811 -0.00020021]
 [ 0.00021112 -0.00021336]
 [ 0.00021253 -0.00021478]
 [ 0.00020708 -0.00020927]
 [ 0.00021077 -0.000213  ]
 [ 0.00021147 -0.00021371]
 [ 0.00020356 -0.00020572]
 [ 0.00021218 -0.00021442]
 [ 0.0002113  -0.00021354]
 [ 0.00020356 -0.00020572]
 [ 0.00021305 -0.00021531]
 [ 0.00021464 -0.00021691]
 [ 0.00021393 -0.0002162 ]
 [ 0.00020585 -0.00020803]
 [ 0.00020391 -0.00020607]
 [ 0.00021446 -0.00021673]
 [ 0.00020866 -0.00021087]
 [ 0.00020725 -0.00020945]
 [ 0.00020286 -0.00020501]
 [ 0.00020778 -0.00020998]
 [ 0.00021552 -0.0002178 ]
 [ 0.00021024 -0.00021247]
 [ 0.00020602 -0.00020821]
 [ 0.00021235 -0.0002146 ]
 [ 0.00020831 -0.00021051]
 [ 0.0002113  -0.00021354]
 [ 0.00020637 -0.00020856]
 [ 0.00020145 -0.00020359]
 [ 0.00020514 -0.00020732]
 [ 0.00019776 -0.00019986]
 [ 0.00020637 -0.00020856]
 [ 0.00020251 -0.00020465]
 [ 0.00021112 -0.00021336]
 [ 0.00020216 -0.0002043 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020884 -0.00021105]
 [ 0.00021024 -0.00021247]
 [ 0.00021147 -0.00021371]
 [ 0.00020321 -0.00020536]
 [ 0.00020901 -0.00021123]
 [ 0.00020743 -0.00020963]
 [ 0.000196   -0.00019808]
 [ 0.00020198 -0.00020412]
 [ 0.0002069  -0.00020909]
 [ 0.00020567 -0.00020785]
 [ 0.0002069  -0.00020909]
 [ 0.00020796 -0.00021016]
 [ 0.00020778 -0.00020998]
 [ 0.00020145 -0.00020359]
 [ 0.00020655 -0.00020874]
 [ 0.00021604 -0.00021833]
 [ 0.00020198 -0.00020412]
 [ 0.00020901 -0.00021123]
 [ 0.00021569 -0.00021798]
 [ 0.00020936 -0.00021158]
 [ 0.00021024 -0.00021247]
 [ 0.00020409 -0.00020625]
 [ 0.00020848 -0.00021069]
 [ 0.00020444 -0.00020661]
 [ 0.00021112 -0.00021336]
 [ 0.00020655 -0.00020874]
 [ 0.00020637 -0.00020856]
 [ 0.00021165 -0.00021389]
 [ 0.00020848 -0.00021069]
 [ 0.00020989 -0.00021211]
 [ 0.00020708 -0.00020927]
 [ 0.00020884 -0.00021105]
 [ 0.00021534 -0.00021762]
 [ 0.0002011  -0.00020323]
 [ 0.00020409 -0.00020625]
 [ 0.0002018  -0.00020394]
 [ 0.00020391 -0.00020607]
 [ 0.00020444 -0.00020661]
 [ 0.00021604 -0.00021833]
 [ 0.00021112 -0.00021336]
 [ 0.00019846 -0.00020057]
 [ 0.00021288 -0.00021513]
 [ 0.00021042 -0.00021265]
 [ 0.00020936 -0.00021158]
 [ 0.00019952 -0.00020163]
 [ 0.00020356 -0.00020572]
 [ 0.00020866 -0.00021087]
 [ 0.0002011  -0.00020323]
 [ 0.00020954 -0.00021176]
 [ 0.00020796 -0.00021016]
 [ 0.00021622 -0.00021851]
 [ 0.00020602 -0.00020821]
 [ 0.0002113  -0.00021354]
 [ 0.00021499 -0.00021727]
 [ 0.00020848 -0.00021069]
 [ 0.00021868 -0.000221  ]
 [ 0.00020831 -0.00021051]
 [ 0.0002076  -0.0002098 ]
 [ 0.00020866 -0.00021087]
 [ 0.00020813 -0.00021034]
 [ 0.00021042 -0.00021265]
 [ 0.00020708 -0.00020927]
 [ 0.0002004  -0.00020252]
 [ 0.00020884 -0.00021105]
 [ 0.00020725 -0.00020945]
 [ 0.00020321 -0.00020536]
 [ 0.00019214 -0.00019417]
 [ 0.0002018  -0.00020394]
 [ 0.00020444 -0.00020661]
 [ 0.00020919 -0.0002114 ]
 [ 0.00021042 -0.00021265]
 [ 0.00021323 -0.00021549]
 [ 0.00019618 -0.00019826]
 [ 0.00020409 -0.00020625]
 [ 0.00020321 -0.00020536]
 [ 0.00020919 -0.0002114 ]
 [ 0.0002011  -0.00020323]
 [ 0.00021358 -0.00021584]
 [ 0.00020831 -0.00021051]
 [ 0.00021569 -0.00021798]
 [ 0.00020813 -0.00021034]
 [ 0.00020971 -0.00021194]
 [ 0.00020567 -0.00020785]
 [ 0.00020725 -0.00020945]
 [ 0.00020233 -0.00020447]
 [ 0.0002055  -0.00020767]
 [ 0.00020286 -0.00020501]
 [ 0.00019846 -0.00020057]
 [ 0.00020479 -0.00020696]
 [ 0.00020339 -0.00020554]
 [ 0.00020901 -0.00021123]
 [ 0.00020919 -0.0002114 ]
 [ 0.00019987 -0.00020199]
 [ 0.00020936 -0.00021158]
 [ 0.00021464 -0.00021691]
 [ 0.00020286 -0.00020501]
 [ 0.00020514 -0.00020732]
 [ 0.00020971 -0.00021194]
 [ 0.00020251 -0.00020465]
 [ 0.00020831 -0.00021051]
 [ 0.00020532 -0.00020749]
 [ 0.00021411 -0.00021638]
 [ 0.00021077 -0.000213  ]
 [ 0.00021604 -0.00021833]
 [ 0.00020321 -0.00020536]
 [ 0.00021411 -0.00021638]
 [ 0.00021182 -0.00021407]
 [ 0.00020954 -0.00021176]
 [ 0.00020971 -0.00021194]
 [ 0.00020514 -0.00020732]
 [ 0.00020585 -0.00020803]
 [ 0.00020005 -0.00020217]
 [ 0.00019987 -0.00020199]
 [ 0.00020022 -0.00020234]]
positive mean=0.00021355401258915663, std=7.162120709836017e-06
negative mean=0.0002946807653643191, std=7.565464784420328e-06
predicted_label: [1 0 0 0 1]
y: [0 1 1 1 0]
batch_size=1024,class_num=2,acc=0.000000,time_used=0.163757
returning from NormbasedScoring
norm_leak_acc: 0.0
K|bs|LR|num_class|Q|top_trainable|epoch|attack_name|None|main_task_acc|label_recovery_rate,2|1024|0.010000|2|1|1|3|NormbasedScoring|None|0.9985815602836879|0.0|0.0
